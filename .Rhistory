dplyr::summarize (area_ha = sum (area_ha)))
area.mid.seral.lu <- st_drop_geometry (st_intersection (mid.seral, lu) %>%
dplyr::group_by (BEC_ZONE_CODE, LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (area_ha = sum (area_ha)))
View(area.mid.seral.lu)
area.mid.seral.lu <- st_drop_geometry (st_intersection (mid.seral, lu) %>%
dplyr::group_by (BEC_ZONE_CODE, LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (mid_seral_area_ha = sum (area_ha)))
sf::st_area(bec$GEOMETRY)
area.bec.lu <- st_drop_geometry (st_intersection (bec, lu) %>%
dplyr::mutate (area_m2 = sf::st_area(GEOMETRY)) %>%
dplyr::group_by (ZONE, LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (bec_area_m2 = sum (area_ha)))
View(area.bec.lu)
area.bec.lu$bec_area_ha <- area.bec.lu$bec_area_m2 * 0.0001
View(area.bec.lu)
area.mid.seral.lu <- merge (area.mid.seral.lu, area.bec.lu, by = "LANDSCAPE_UNIT_NAME")
View(area.mid.seral.lu)
View(mid.seral)
View(area.mid.seral.lu)
area.mid.seral.lu <- st_drop_geometry (st_intersection (mid.seral, lu) %>%
dplyr::group_by (BEC_ZONE_CODE, LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (mid_seral_area_ha = sum (area_ha)))
View(area.mid.seral.lu)
View(area.mid.seral.lu)
mid.seral <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "mid_seral"))
area.mid.seral.lu <- st_drop_geometry (st_intersection (mid.seral, lu) %>%
dplyr::mutate (area_m2 = sf::st_area(GEOMETRY)) %>%
dplyr::group_by (BEC_ZONE_CODE, LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (mid_seral_area_ha = sum (area_m2 * 0.0001)))
View(area.mid.seral.lu)
View(area.mid.seral.lu)
area.mid.seral.lu <- st_drop_geometry (st_intersection (mid.seral, lu) %>%
dplyr::mutate (area_m2 = sf::st_area(GEOMETRY)) %>%
dplyr::group_by (BEC_ZONE_CODE, LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (mid_seral_area_ha = sum (drop_units (area_m2) * 0.0001)))
library (units)
area.mid.seral.lu <- st_drop_geometry (st_intersection (mid.seral, lu) %>%
dplyr::mutate (area_m2 = sf::st_area(GEOMETRY)) %>%
dplyr::group_by (BEC_ZONE_CODE, LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (mid_seral_area_ha = sum (units::drop_units (area_m2) * 0.0001)))
area.bec.lu <- st_drop_geometry (st_intersection (bec, lu) %>%
dplyr::mutate (area_m2 = sf::st_area(GEOMETRY)) %>%
dplyr::group_by (ZONE, LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (bec_area_m2 = sum (units::drop_units (area_m2) * 0.0001)))
View(area.bec.lu)
area.bec.lu <- st_drop_geometry (st_intersection (bec, lu) %>%
dplyr::mutate (area_m2 = sf::st_area(GEOMETRY)) %>%
dplyr::group_by (ZONE, LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (bec_area_ha = sum (units::drop_units (area_m2) * 0.0001)))
View(area.bec.lu)
View(area.bec.lu)
area.mid.seral.lu <- merge (area.mid.seral.lu, area.bec.lu, by = "LANDSCAPE_UNIT_NAME")
View(area.mid.seral.lu)
#area.bec.lu$bec_area_ha <- area.bec.lu$bec_area_m2 * 0.0001
names(area.mid.seral.lu) [names (area.mid.seral.lu) == 'BEC_ZONE_CODE'] <- 'ZONE'
area.mid.seral.lu <- st_drop_geometry (st_intersection (mid.seral, lu) %>%
dplyr::mutate (area_m2 = sf::st_area(GEOMETRY)) %>%
dplyr::group_by (BEC_ZONE_CODE, LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (mid_seral_area_ha = sum (units::drop_units (area_m2) * 0.0001)))
area.bec.lu <- st_drop_geometry (st_intersection (bec, lu) %>%
dplyr::mutate (area_m2 = sf::st_area(GEOMETRY)) %>%
dplyr::group_by (ZONE, LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (bec_area_ha = sum (units::drop_units (area_m2) * 0.0001)))
#area.bec.lu$bec_area_ha <- area.bec.lu$bec_area_m2 * 0.0001
names (area.mid.seral.lu) [names (area.mid.seral.lu) == 'BEC_ZONE_CODE'] <- 'ZONE'
area.mid.seral.lu <- merge (area.mid.seral.lu, area.bec.lu, by = c ('ZONE', "LANDSCAPE_UNIT_NAME"))
View(area.mid.seral.lu)
lu <-  merge (area.mid.seral.lu, lu, by = "LANDSCAPE_UNIT_NAME")
area.mid.seral.lu$perc_mid_seral <- (area.mid.seral.lu$mid_seral_area_ha / area.mid.seral.lu$bec_area_ha) * 100
lu <-  merge (area.mid.seral.lu, lu, by = "LANDSCAPE_UNIT_NAME")
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percet Mid-seral Conifer Forest in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.3, 0.6, 0.75, 1)) +
guides (fill = guide_legend (title = "Psercent Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
lu <-  merge (area.mid.seral.lu, lu, by = "LANDSCAPE_UNIT_NAME")
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percet Mid-seral Conifer Forest in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.3, 0.6, 0.75, 1)) +
guides (fill = guide_legend (title = "Psercent Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
View(lu)
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
lu <-  merge (area.mid.seral.lu, lu, by = "LANDSCAPE_UNIT_NAME")
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percet Mid-seral Conifer Forest in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.3, 0.6, 0.75, 1)) +
guides (fill = guide_legend (title = "Psercent Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
View(lu)
ggplot (data = lu)
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral))
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
lu <-  merge (lu, area.mid.seral.lu,  by = "LANDSCAPE_UNIT_NAME")
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral))
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.3, 0.6, 0.75, 1)) +
guides (fill = guide_legend (title = "Percent Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.3, 0.6, 0.75, 1)) +
guides (fill = guide_legend (title = "Percent Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.3, 0.6, 0.75, 1)) +
guides (fill = guide_legend (title = "Percent Mid-Seral"))
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma") +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 30, 50, 75, 100)) +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
Units Overlapping the Kispiox Timber Supply Area") +
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 30, 50, 75, 100)) +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
View(lu)
area.mid.seral.lu <- st_drop_geometry (st_intersection (mid.seral, lu) %>%
dplyr::filter (BEC_ZONE_CODE == 'CWH' | BEC_ZONE_CODE == 'ICH' | BEC_ZONE_CODE == 'SBS')
dplyr::mutate (area_m2 = sf::st_area(GEOMETRY)) %>%
area.mid.seral.lu <- st_drop_geometry (st_intersection (mid.seral, lu) %>%
dplyr::filter (BEC_ZONE_CODE == 'CWH' |
BEC_ZONE_CODE == 'ICH' | BEC_ZONE_CODE == 'SBS') %>%
dplyr::mutate (area_m2 = sf::st_area(GEOMETRY)) %>%
dplyr::group_by (LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (mid_seral_area_ha = sum (units::drop_units (area_m2) * 0.0001)))
area.bec.lu <- st_drop_geometry (st_intersection (bec, lu) %>%
dplyr::filter (ZONE == 'CWH' | ZONE == 'ICH' | ZONE == 'SBS') %>%
dplyr::mutate (area_m2 = sf::st_area(GEOMETRY)) %>%
dplyr::group_by (LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (bec_area_ha = sum (units::drop_units (area_m2) * 0.0001)))
#area.bec.lu$bec_area_ha <- area.bec.lu$bec_area_m2 * 0.0001
names (area.mid.seral.lu) [names (area.mid.seral.lu) == 'BEC_ZONE_CODE'] <- 'ZONE'
area.mid.seral.lu <- merge (area.mid.seral.lu, area.bec.lu, by = c ('ZONE', "LANDSCAPE_UNIT_NAME"))
area.mid.seral.lu <- merge (area.mid.seral.lu, area.bec.lu, by = c ("LANDSCAPE_UNIT_NAME"))
area.mid.seral.lu$perc_mid_seral <- (area.mid.seral.lu$mid_seral_area_ha / area.mid.seral.lu$bec_area_ha) * 100
lu <-  merge (lu, area.mid.seral.lu,  by = "LANDSCAPE_UNIT_NAME")
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 30, 50, 75, 100)) +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu)
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral))
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
lu <-  merge (lu, area.mid.seral.lu,  by = "LANDSCAPE_UNIT_NAME")
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 30, 50, 75, 100)) +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
lu$perc_mid_seral
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 30, 50, 75, 100)) +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 30)) +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 30, 40, 50, 60, 70, 80, 90, 100)) +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
knitr::opts_chunk$set(echo = TRUE)
library (here)
library (ggplot2)
library (data.table)
library (sf)
library (dplyr)
library (viridis)
library (ggrepel)
library (ggspatial)
library (units)
tsa_bound <- st_make_valid (sf::st_read(here ("data/kispiox/kispiox_2021.gdb"), layer = "tsa_bound"))
gbpu <- st_make_valid (sf::st_read(here ("data/kispiox/kispiox_2021.gdb"), layer = "gbpu"))
roads <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "roads_dra_ften"))
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
wha <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "wha_6055"))
bec <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "bec"))
mid.seral <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "mid_seral"))
area.mid.seral.lu <- st_drop_geometry (st_intersection (mid.seral, lu) %>%
dplyr::mutate (area_m2 = sf::st_area(GEOMETRY)) %>%
dplyr::group_by (LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (mid_seral_area_ha = sum (units::drop_units (area_m2) * 0.0001)))
View(area.mid.seral.lu)
area.bec.lu <- st_drop_geometry (st_intersection (bec, lu) %>%
dplyr::filter (ZONE == 'CWH' | ZONE == 'ICH' | ZONE == 'SBS') %>%
dplyr::mutate (area_m2 = sf::st_area(GEOMETRY)) %>%
dplyr::group_by (LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (bec_area_ha = sum (units::drop_units (area_m2) * 0.0001)))
View(area.bec.lu)
View(area.bec.lu)
View(area.mid.seral.lu)
#area.bec.lu$bec_area_ha <- area.bec.lu$bec_area_m2 * 0.0001
area.mid.seral.lu <- merge (area.mid.seral.lu, area.bec.lu, by = c ("LANDSCAPE_UNIT_NAME"))
View(area.mid.seral.lu)
area.mid.seral.lu$perc_mid_seral <- (area.mid.seral.lu$mid_seral_area_ha / area.mid.seral.lu$bec_area_ha) * 100
View(area.mid.seral.lu)
lu <-  merge (lu, area.mid.seral.lu,  by = "LANDSCAPE_UNIT_NAME")
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 5, 10, 15, 20, 30, 40, 50, 100)) +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 5, 10, 15, 20, 30)) +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 5, 10)) +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
View(area.mid.seral.lu)
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 1, 2, 4, 5, 10)) +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
View(area.mid.seral.lu)
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-seral Conifer Forest in Landscape
Units Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 1, 2, 4, 5, 6, 7, 8)) +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line. GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
View(area.mid.seral.lu)
t.gbpu <- as.data.table (gbpu$POPULATION_NAME)
setnames (t.gbpu, "POPULATION_NAME")
t.gbpu [t.gbpu$POPULATION_NAME == "Babine", density := 23]
t.gbpu [t.gbpu$POPULATION_NAME == "Bulkley-Lakes", density := 20]
t.gbpu [t.gbpu$POPULATION_NAME == "Cranberry", density := 30]
gbpu <- merge (gbpu, t.gbpu, by = "POPULATION_NAME")
View(t.gbpu)
lu$road_dens
lu.road.length <- st_drop_geometry (st_intersection (roads, lu) %>%
dplyr::mutate (length_m = sf::st_length(Shape)) %>%
dplyr::group_by (LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (length_m = sum(length_m)))
lu.road.length <- st_drop_geometry (st_intersection (roads, lu) %>%
dplyr::mutate (length_m = sf::st_length(Shape)) %>%
dplyr::group_by (LANDSCAPE_UNIT_NAME) %>%
dplyr::summarize (length_m = sum(length_m)))
lu.road.length$road_length_km <- lu.road.length$length_m / 1000
lu.road.length$road_length_km  <- units::drop_units (lu.road.length$road_length_km )
setDT (lu.road.length) [, length_m := NULL]
lu <- merge (lu, lu.road.length, by = "LANDSCAPE_UNIT_NAME")
lu$area_km2 <- lu$GEOMETRY_Area / 1000000
lu$road_dens <- lu$road_length_km / lu$area_km2
lu$road_dens
ggplot (data = lu) +
geom_sf (aes (fill = road_dens)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Density of Roads in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6)) +
guides (fill = guide_legend (title = "Road Density (km/km2)")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.
GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu) +
geom_sf (aes (fill = perc_mid_seral)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
geom_sf (data = gbpu, fill = NA, linetype = "longdash", size = 0.9, colour = "blue") +
#geom_sf_label (data = gbpu, aes(label = POPULATION_NAME)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent Mid-Seral CWH, ICH and SBS
Conifer Forest in Landscape Units Overlapping
the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 1, 2, 4, 5, 6, 7, 8)) +
guides (fill = guide_legend (title = "Percent (%) Mid-Seral")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.
GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
1657*0.14
1061*.16
1595*.19
638*.33
517*.28
14/5
