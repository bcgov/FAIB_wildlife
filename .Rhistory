bec <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "bec"))
mid.seral <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "mid_seral"))
data.moose.pop <- read.csv (file = here ("data/kispiox/moose_density_20211125.csv"),
header = T)
lu$area <- st_area (lu)
lu$area_km2 <- lu$area / 1000000
lu$area_km2 <- units::drop_units (lu$area_km2)
lu.roads <- st_intersection (lu, roads)
lu.roads$length <- st_length (lu.roads)
lu.roads$road_length_km <- lu.roads$length / 1000
lu.roads$road_length_km <- units::drop_units (lu.roads$road_length_km)
data.lu.roads <- as.data.frame (st_drop_geometry (lu.roads))
data.lu.road.length <- as.data.table (data.lu.roads %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
summarise (road_length_km = sum (road_length_km)))
data.lu <- as.data.frame (st_drop_geometry (lu))
data.lu.road.length <- merge (data.lu.road.length, data.lu [ , c("area_km2", "LANDSCAPE_UNIT_NAME")], by = "LANDSCAPE_UNIT_NAME")
data.lu.road.length$road_density <- data.lu.road.length$road_length_km / data.lu.road.length$area_km2
data.lu.road.length$brks_rd_dn <- cut (data.lu.road.length$road_density,
breaks = c (-Inf, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, Inf),
labels = c ("0 - 0.09", "0.10 - 0.19", "0.20 - 0.29", "0.30 - 0.39",
"0.40 - 0.49", "0.50 - 0.59", "0.60 - 0.69", "0.70 - 0.79",
"0.80 - 0.89", "0.90 - 0.99", ">1.00"))
lu <- merge (lu, data.lu.road.length, by = "LANDSCAPE_UNIT_NAME")
ggplot (data = lu) +
geom_sf (aes (fill = road_density)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Density of Roads in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6)) +
guides (fill = guide_legend (title = "Road Density (km/km2)")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu) +
geom_sf (aes (fill = road_density)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Density of Roads in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6)) +
guides (fill = guide_legend (title = "Road Density (km/km2)")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
cutblocks <- st_make_valid (sf::st_read(here ("data/kispiox/kispiox_2021.gdb"), layer = "cutblocks"))
lu.cut <- st_intersection (lu, cutblocks)
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
lu.cut <- st_intersection (lu, cutblocks)
View(lu.cut)
lu.cut$area <- st_area (lu.cut)
lu.cut$area_km2 <- lu.cut$area / 1000000
lu.cut$area_km2 <- units::drop_units (lu.cut$area_km2)
data.lu.cut <- as.data.frame (st_drop_geometry (lu.cut))
View(data.lu.cut)
data.lu.cut.area <- as.data.table (data.lu.cut %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
summarise (cut_area_km2 = sum (area_km2)))
View(data.lu.cut.area)
data.lu.cut.area <- as.data.table (data.lu.cut %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
filter (HARVEST_YEAR > 1989 & HARVEST_YEAR < 2015)
summarise (cut_area_km2 = sum (area_km2)))
data.lu.cut.area <- as.data.table (data.lu.cut %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
filter (HARVEST_YEAR > 1989 & HARVEST_YEAR < 2015) %>%
summarise (cut_area_km2 = sum (area_km2)))
View(data.lu.cut.area)
View(data.lu.cut.area)
data.lu <- as.data.frame (st_drop_geometry (lu))
data.lu.road.length <- merge (data.lu.cut.area, data.lu [ , c("area_km2", "LANDSCAPE_UNIT_NAME")], by = "LANDSCAPE_UNIT_NAME")
lu$area <- st_area (lu)
lu$area_km2 <- lu$area / 1000000
lu$area_km2 <- units::drop_units (lu$area_km2)
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
lu.cut <- st_intersection (lu, cutblocks)
lu.cut$area <- st_area (lu.cut)
lu.cut$area_km2 <- lu.cut$area / 1000000
lu.cut$area_km2 <- units::drop_units (lu.cut$area_km2)
data.lu.cut <- as.data.frame (st_drop_geometry (lu.cut))
data.lu.cut.area <- as.data.table (data.lu.cut %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
filter (HARVEST_YEAR > 1989 & HARVEST_YEAR < 2015) %>%
summarise (cut_area_km2 = sum (area_km2)))
lu$area <- st_area (lu)
lu$area_km2 <- lu$area / 1000000
lu$area_km2 <- units::drop_units (lu$area_km2)
data.lu <- as.data.frame (st_drop_geometry (lu))
data.lu.road.length <- merge (data.lu.cut.area, data.lu [ , c("area_km2", "LANDSCAPE_UNIT_NAME")], by = "LANDSCAPE_UNIT_NAME")
View(data.lu.road.length)
data.lu.cut.area <- merge (data.lu.cut.area, data.lu [ , c("area_km2", "LANDSCAPE_UNIT_NAME")], by = "LANDSCAPE_UNIT_NAME")
View(data.lu.cut.area)
data.lu.cut.area$road_density <- data.lu.cut.area$cut_area_km2 / data.lu.cut.area$area_km2
View(data.lu.cut.area)
data.lu.cut.area$cut_perc <- (data.lu.cut.area$cut_area_km2 / data.lu.cut.area$area_km2) * 100
View(data.lu.cut.area)
vri <- st_make_valid (sf::st_read(here ("data/kispiox/kispiox_2021.gdb"), layer = "vri"))
lu.vri <- st_intersection (lu, vri)
lu.vri$poly_area <- st_area (lu.vri)
lu.vri$poly_area_km2 <- lu.vri$poly_area / 1000000
lu.vri$poly_area_km2 <- units::drop_units (lu.vri$poly_area_km2)
data.lu.vri <- as.data.frame (st_drop_geometry (lu.vri))
View(data.lu.vri)
unique (data.lu.vri$BCLCS_LEVEL_1)
unique (data.lu.vri$BCLCS_LEVEL_2)
unique (data.lu.vri$BCLCS_LEVEL_13
unique (data.lu.vri$BCLCS_LEVEL_3)
unique (data.lu.vri$BCLCS_LEVEL_4)
data.forest.area <- as.data.table (data.lu.vri %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
filter (BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "T" &
BCLCS_LEVEL_4 == "TC" | BCLCS_LEVEL_4 =="TB" | BCLCS_LEVEL_4 =="TM") %>%
summarise (forested_area_km2 = sum (poly_area_km2)))
View(data.forest.area)
View(data.forest.area)
data.lu.vri <- as.data.table (st_drop_geometry (lu.vri))
data.forest.area <- data.lu.vri %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
filter (BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "T" &
BCLCS_LEVEL_4 == "TC" | BCLCS_LEVEL_4 =="TB" |
BCLCS_LEVEL_4 =="TM") %>%
summarise (forested_area_km2 = sum (poly_area_km2))
View(data.forest.area)
data.forest.area <- data.lu.vri %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
filter (BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "T" &
BCLCS_LEVEL_4 == "TC" | BCLCS_LEVEL_4 =="TB" |
BCLCS_LEVEL_4 =="TM")
View(data.forest.area)
data.forest.area <- data.lu.vri %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
filter (BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "T" &
BCLCS_LEVEL_4 == "TC" | BCLCS_LEVEL_4 =="TB" |
BCLCS_LEVEL_4 =="TM") %>%
summarise (forested_area_km2 = sum (poly_area_km2))
data.lu.cut.forest.area <- merge (data.lu.cut.area, data.forest.area [ , c("LANDSCAPE_UNIT_NAME", "forested_area_km2",)], by = "LANDSCAPE_UNIT_NAME")
data.lu.cut.forest.area <- merge (data.forest.area, data.lu [ , c("LANDSCAPE_UNIT_NAME", "forested_area_km2",)], by = "LANDSCAPE_UNIT_NAME")
data.lu.cut.forestarea <- merge (data.lu.cut.area, data.forest.area, by = "LANDSCAPE_UNIT_NAME")
data.lu.cut.forest.area <- merge (data.lu.cut.area, data.forest.area, by = "LANDSCAPE_UNIT_NAME")
lu <- merge (lu, data.lu.cut.forest.area, by = "LANDSCAPE_UNIT_NAME")
View(data.lu.cut.forestarea)
gc ()
knitr::opts_chunk$set(echo = TRUE)
library (here)
library (ggplot2)
library (data.table)
library (sf)
library (dplyr)
library (viridis)
library (ggrepel)
library (ggspatial)
library (units)
tsa_bound <- st_make_valid (sf::st_read(here ("data/kispiox/kispiox_2021.gdb"), layer = "tsa_bound"))
cutblocks <- st_make_valid (sf::st_read(here ("data/kispiox/kispiox_2021.gdb"), layer = "cutblocks"))
vri <- st_make_valid (sf::st_read(here ("data/kispiox/kispiox_2021.gdb"), layer = "vri"))
wmu <- st_make_valid (sf::st_read(here ("data/kispiox/kispiox_2021.gdb"), layer = "wmu"))
roads <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "roads_dra_ften"))
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
bec <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "bec"))
mid.seral <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "mid_seral"))
data.moose.pop <- read.csv (file = here ("data/kispiox/moose_density_20211125.csv"),
header = T)
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
lu.cut <- st_intersection (lu, cutblocks)
lu.cut$area <- st_area (lu.cut)
lu.cut$area_km2 <- lu.cut$area / 1000000
lu.cut$area_km2 <- units::drop_units (lu.cut$area_km2)
data.lu.cut <- as.data.frame (st_drop_geometry (lu.cut))
data.lu.cut.area <- as.data.table (data.lu.cut %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
filter (HARVEST_YEAR > 1989 & HARVEST_YEAR < 2015) %>%
summarise (cut_area_km2 = sum (area_km2)))
lu$area <- st_area (lu)
lu$area_km2 <- lu$area / 1000000
lu$area_km2 <- units::drop_units (lu$area_km2)
data.lu <- as.data.frame (st_drop_geometry (lu))
# area that is forested
lu.vri <- st_intersection (lu, vri)
# area that is forested
lu.vri <- st_intersection (lu, vri)
lu.vri$poly_area <- st_area (lu.vri
lu.vri$poly_area <- st_area (lu.vri)
lu.vri$poly_area_km2 <- lu.vri$poly_area / 1000000
lu.vri$poly_area_km2 <- units::drop_units (lu.vri$poly_area_km2)
data.lu.vri <- as.data.table (st_drop_geometry (lu.vri))
data.forest.area <- data.lu.vri %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
filter (BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "T" &
BCLCS_LEVEL_4 == "TC" | BCLCS_LEVEL_4 =="TB" |
BCLCS_LEVEL_4 =="TM") %>%
summarise (forested_area_km2 = sum (poly_area_km2))
data.lu.cut.forest.area <- merge (data.lu.cut.area, data.forest.area, by = "LANDSCAPE_UNIT_NAME")
View(data.lu.cut.forest.area)
View(data.lu.cut.forest.area)
data.lu.cut.area$cut_perc_forest <- (data.lu.cut.area$cut_area_km2 / data.lu.cut.area$forested_area_km2) * 100
lu <- merge (lu, data.lu.cut.forest.area, by = "LANDSCAPE_UNIT_NAME")
ggplot (data = lu) +
geom_sf (aes (fill = cut_perc_forest))
data.lu.cut.forest.area$cut_perc_forest <- (data.lu.cut.forest.area$cut_area_km2 / data.lu.cut.forest.area$forested_area_km2) * 100
lu <- merge (lu, data.lu.cut.forest.area, by = "LANDSCAPE_UNIT_NAME")
ggplot (data = lu) +
geom_sf (aes (fill = cut_perc_forest))
ggplot (data = lu) +
geom_sf (aes (fill = cut_perc_forest)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent of Forested Area that are
Cutblocks 5 to 30 years old in
Landscape Units Overlapping the
Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 1, 2, 4, 5, 6, 7, 8)) +
guides (fill = guide_legend (title = "Percent (%) Cutblocks")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.
GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu) +
geom_sf (aes (fill = cut_perc_forest)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent of Forested Area that are Cutblocks
5 to 30 years old in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 1, 2, 4, 5, 6, 7, 8)) +
guides (fill = guide_legend (title = "Percent (%) Cutblocks")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.
GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
View(data.lu.cut.forest.area)
lu$area <- st_area (lu)
lu$area_km2 <- lu$area / 1000000
lu$area_km2 <- units::drop_units (lu$area_km2)
lu.roads <- st_intersection (lu, roads)
lu.roads$length <- st_length (lu.roads)
lu.roads$road_length_km <- lu.roads$length / 1000
lu.roads$road_length_km <- units::drop_units (lu.roads$road_length_km)
data.lu.roads <- as.data.frame (st_drop_geometry (lu.roads))
data.lu.road.length <- as.data.table (data.lu.roads %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
summarise (road_length_km = sum (road_length_km)))
data.lu <- as.data.frame (st_drop_geometry (lu))
data.lu.road.length <- merge (data.lu.road.length, data.lu [ , c("area_km2", "LANDSCAPE_UNIT_NAME")], by = "LANDSCAPE_UNIT_NAME")
data.lu.road.length$road_density <- data.lu.road.length$road_length_km / data.lu.road.length$area_km2
data.lu.road.length$brks_rd_dn <- cut (data.lu.road.length$road_density,
breaks = c (-Inf, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, Inf),
labels = c ("0 - 0.09", "0.10 - 0.19", "0.20 - 0.29", "0.30 - 0.39",
"0.40 - 0.49", "0.50 - 0.59", "0.60 - 0.69", "0.70 - 0.79",
"0.80 - 0.89", "0.90 - 0.99", ">1.00"))
lu <- merge (lu, data.lu.road.length, by = "LANDSCAPE_UNIT_NAME")
ggplot (data = lu) +
geom_sf (aes (fill = road_density)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Density of Roads in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6)) +
guides (fill = guide_legend (title = "Road Density (km/km2)")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu) +
geom_sf (aes (fill = road_density)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Density of Roads in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6)) +
guides (fill = guide_legend (title = "Road Density (km/km2)")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
lu$area <- st_area (lu)
lu$area_km2 <- lu$area / 1000000
lu$area_km2 <- units::drop_units (lu$area_km2)
lu.roads <- st_intersection (lu, roads)
lu.roads$length <- st_length (lu.roads)
lu.roads$road_length_km <- lu.roads$length / 1000
lu.roads$road_length_km <- units::drop_units (lu.roads$road_length_km)
data.lu.roads <- as.data.frame (st_drop_geometry (lu.roads))
data.lu.road.length <- as.data.table (data.lu.roads %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
summarise (road_length_km = sum (road_length_km)))
data.lu <- as.data.frame (st_drop_geometry (lu))
data.lu.road.length <- merge (data.lu.road.length, data.lu [ , c("area_km2", "LANDSCAPE_UNIT_NAME")], by = "LANDSCAPE_UNIT_NAME", all = TRUE)
data.lu.road.length$road_density <- data.lu.road.length$road_length_km / data.lu.road.length$area_km2
data.lu.road.length$brks_rd_dn <- cut (data.lu.road.length$road_density,
breaks = c (-Inf, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, Inf),
labels = c ("0 - 0.09", "0.10 - 0.19", "0.20 - 0.29", "0.30 - 0.39",
"0.40 - 0.49", "0.50 - 0.59", "0.60 - 0.69", "0.70 - 0.79",
"0.80 - 0.89", "0.90 - 0.99", ">1.00"))
lu <- merge (lu, data.lu.road.length, by = "LANDSCAPE_UNIT_NAME")
ggplot (data = lu) +
geom_sf (aes (fill = road_density)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Density of Roads in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6)) +
guides (fill = guide_legend (title = "Road Density (km/km2)")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu) +
geom_sf (aes (fill = road_density)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Density of Roads in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6)) +
guides (fill = guide_legend (title = "Road Density (km/km2)")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
View(lu)
test <-  as.data.frame (st_drop_geometry (lu))
View(test)
lu$road_density [is.na(lu$road_density)] <- 0
ggplot (data = lu) +
geom_sf (aes (fill = road_density)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Density of Roads in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6)) +
guides (fill = guide_legend (title = "Road Density (km/km2)")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
lu.cut <- st_intersection (lu, cutblocks)
lu.cut$area <- st_area (lu.cut)
lu.cut$area_km2 <- lu.cut$area / 1000000
lu.cut$area_km2 <- units::drop_units (lu.cut$area_km2)
data.lu.cut <- as.data.frame (st_drop_geometry (lu.cut))
data.lu.cut.area <- as.data.table (data.lu.cut %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
filter (HARVEST_YEAR > 1989 & HARVEST_YEAR < 2015) %>%
summarise (cut_area_km2 = sum (area_km2)))
lu$area <- st_area (lu)
lu$area_km2 <- lu$area / 1000000
lu$area_km2 <- units::drop_units (lu$area_km2)
data.lu <- as.data.frame (st_drop_geometry (lu))
data.lu.cut.area <- merge (data.lu.cut.area, data.lu [ , c("area_km2", "LANDSCAPE_UNIT_NAME")], by = "LANDSCAPE_UNIT_NAME", all = T)
data.lu.cut.area$cut_perc_forest [ is.na (data.lu.cut.area$cut_perc_forest)] <- 0
# area that is forested
lu.vri <- st_intersection (lu, vri)
lu.vri$poly_area <- st_area (lu.vri)
lu.vri$poly_area_km2 <- lu.vri$poly_area / 1000000
lu.vri$poly_area_km2 <- units::drop_units (lu.vri$poly_area_km2)
data.lu.vri <- as.data.table (st_drop_geometry (lu.vri))
data.forest.area <- data.lu.vri %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
filter (BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "T" &
BCLCS_LEVEL_4 == "TC" | BCLCS_LEVEL_4 =="TB" |
BCLCS_LEVEL_4 =="TM") %>%
summarise (forested_area_km2 = sum (poly_area_km2))
data.lu.cut.forest.area <- merge (data.lu.cut.area, data.forest.area, by = "LANDSCAPE_UNIT_NAME")
data.lu.cut.forest.area$cut_perc_forest <- (data.lu.cut.forest.area$cut_area_km2 / data.lu.cut.forest.area$forested_area_km2) * 100
lu <- merge (lu, data.lu.cut.forest.area, by = "LANDSCAPE_UNIT_NAME", all = T)
lu$cut_perc_forest [ is.na (lu$cut_perc_forest)] <- 0
ggplot (data = lu) +
geom_sf (aes (fill = cut_perc_forest)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent of Forested Area that are Cutblocks
5 to 30 years old in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 1, 2, 4, 5, 6, 7, 8)) +
guides (fill = guide_legend (title = "Percent (%) Cutblocks")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.
GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
ggplot (data = lu) +
geom_sf (aes (fill = cut_perc_forest)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Percent of Forested Area that are Cutblocks
5 to 30 years old in Landscape Units
Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 1, 2, 4, 5, 6, 7, 8)) +
guides (fill = guide_legend (title = "Percent (%) Cutblocks")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.
GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
View(data.lu.cut.forest.area)
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
knitr::opts_chunk$set(echo = TRUE)
library (here)
library (ggplot2)
library (data.table)
library (sf)
library (dplyr)
library (viridis)
library (ggrepel)
library (ggspatial)
library (units)
tsa_bound <- st_make_valid (sf::st_read(here ("data/kispiox/kispiox_2021.gdb"), layer = "tsa_bound"))
cutblocks <- st_make_valid (sf::st_read(here ("data/kispiox/kispiox_2021.gdb"), layer = "cutblocks"))
vri <- st_make_valid (sf::st_read(here ("data/kispiox/kispiox_2021.gdb"), layer = "vri"))
wmu <- st_make_valid (sf::st_read(here ("data/kispiox/kispiox_2021.gdb"), layer = "wmu"))
roads <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "roads_dra_ften"))
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
bec <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "bec"))
mid.seral <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "mid_seral"))
data.moose.pop <- read.csv (file = here ("data/kispiox/moose_density_20211125.csv"),
header = T)
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
lu <- st_make_valid (sf::st_read (here ("data/kispiox/kispiox_2021.gdb"), layer = "lu"))
lu.cut <- st_intersection (lu, cutblocks)
lu.cut$area <- st_area (lu.cut)
lu.cut$area_km2 <- lu.cut$area / 1000000
lu.cut$area_km2 <- units::drop_units (lu.cut$area_km2)
data.lu.cut <- as.data.frame (st_drop_geometry (lu.cut))
data.lu.cut.area <- as.data.table (data.lu.cut %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
filter (HARVEST_YEAR > 1989 & HARVEST_YEAR < 2015) %>%
summarise (cut_area_km2 = sum (area_km2)))
lu$area <- st_area (lu)
lu$area_km2 <- lu$area / 1000000
lu$area_km2 <- units::drop_units (lu$area_km2)
data.lu <- as.data.frame (st_drop_geometry (lu))
data.lu.cut.area <- merge (data.lu.cut.area, data.lu [ , c("area_km2", "LANDSCAPE_UNIT_NAME")], by = "LANDSCAPE_UNIT_NAME", all = T)
data.lu.cut.area$cut_perc_forest [ is.na (data.lu.cut.area$cut_perc_forest)] <- 0
# area that is forested
lu.vri <- st_intersection (lu, vri)
ggplot (data = lu) +
geom_sf (aes (fill = cut_perc_forest)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
xlab("Longitude") + ylab("Latitude") +
#ggtitle ("Percent of Forested Area that are Cutblocks
#5 to 30 years old in Landscape Units
#Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 1, 2, 4, 5, 6, 7, 8)) +
guides (fill = guide_legend (title = "Percent (%) Cutblocks")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.
GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
# area that is forested
lu.vri <- st_intersection (lu, vri)
lu.vri$poly_area <- st_area (lu.vri)
lu.vri$poly_area_km2 <- lu.vri$poly_area / 1000000
lu.vri$poly_area_km2 <- units::drop_units (lu.vri$poly_area_km2)
data.lu.vri <- as.data.table (st_drop_geometry (lu.vri))
data.forest.area <- data.lu.vri %>%
group_by (LANDSCAPE_UNIT_NAME) %>%
filter (BCLCS_LEVEL_1 == "V" & BCLCS_LEVEL_2 == "T" &
BCLCS_LEVEL_4 == "TC" | BCLCS_LEVEL_4 =="TB" |
BCLCS_LEVEL_4 =="TM") %>%
summarise (forested_area_km2 = sum (poly_area_km2))
data.lu.cut.forest.area <- merge (data.lu.cut.area, data.forest.area, by = "LANDSCAPE_UNIT_NAME")
data.lu.cut.forest.area$cut_perc_forest <- (data.lu.cut.forest.area$cut_area_km2 / data.lu.cut.forest.area$forested_area_km2) * 100
lu <- merge (lu, data.lu.cut.forest.area, by = "LANDSCAPE_UNIT_NAME", all = T)
lu$cut_perc_forest [ is.na (lu$cut_perc_forest)] <- 0
ggplot (data = lu) +
geom_sf (aes (fill = cut_perc_forest)) +
geom_sf (data = tsa_bound, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
xlab("Longitude") + ylab("Latitude") +
#ggtitle ("Percent of Forested Area that are Cutblocks
#5 to 30 years old in Landscape Units
#Overlapping the Kispiox Timber Supply Area") +
scale_fill_viridis (option = "magma", breaks = c (0, 1, 2, 4, 5, 6, 7, 8)) +
guides (fill = guide_legend (title = "Percent (%) Cutblocks")) +
annotation_scale(location = "br", width_hint = 0.5, pad_y = unit(-0.001, "in")) +
annotation_north_arrow(location = "br", which_north = "true",
pad_x = unit(0, "in"), pad_y = unit(0.1, "in"),
style = north_arrow_fancy_orienteering) +
labs (caption = "Kispiox TSA boundary indicated by green dashed line.
GBPUs indicated by blue dashed line.") +
theme (axis.text.x = element_text (angle = 30, hjust = 1))
1.8/2.4
