library (ggrepel)
library (ggspatial)
# load spatial data
sf.caribou.herds <- st_make_valid (st_read (dsn = here ("data/mackenzie/mackenzie_caribou_herds.shp")))
sf.caribou.herds <- sf.caribou.herds %>% # this combines the two Scott polys into one
group_by (CARIBOU_TA) %>%
summarise ()
sf.lu <- st_make_valid (st_read (dsn = here ("data/mackenzie/lu_mac_poly.shp")))
sf.awa <- st_make_valid (st_read (dsn = here ("data/mackenzie/fwa_mac_poly.shp")))
# load data
tab.lu.disturb.data <- as.data.table (read.csv (here ("data/mackenzie/disturbance_by_landscape_unit.csv"),
header = T,
sep = ","))
# join data
sf.lu <- dplyr::full_join (sf.lu, tab.lu.disturb.data, by = "LANDSCAP_2")
# build map
ggplot (data = sf.lu) +
geom_sf (aes (fill = perc_disturb_2030)) +
geom_sf (data = sf.caribou.herds, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
# geom_sf_label(data = sf.caribou.herds, aes(label = CARIBOU_TA)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Disturbance by Landscape Unit in 2030") +
scale_fill_viridis (option="inferno") +
guides (fill = guide_legend (title = "Percent of Landscape Unit Disturbed")) +
annotation_scale(location = "bl", width_hint = 0.5) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.1, "in"), pad_y = unit(0.2, "in"),
style = north_arrow_fancy_orienteering)
# load data
tab.awa.disturb.data <- as.data.table (read.csv (here ("data/mackenzie/disturbance_by_watershed.csv"),
header = T,
sep = ","))
# join data
sf.awa <- dplyr::full_join (sf.awa, tab.awa.disturb.data, by = "WATERSHED_")
# build map
ggplot (data = sf.awa) +
geom_sf (aes (fill = perc_disturb_2030), color = NA) +
geom_sf (data = sf.caribou.herds, fill = NA, linetype = "longdash", size = 1.1, colour = "green")+
# geom_sf_label(data = sf.caribou.herds, aes(label = CARIBOU_TA)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Disturbance by Watershed Area in 2030") +
scale_fill_viridis (option="inferno") +
guides (fill = guide_legend (title = "Percent of Watershed Area Disturbed")) +
annotation_scale(location = "bl", width_hint = 0.5) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.1, "in"), pad_y = unit(0.2, "in"),
style = north_arrow_fancy_orienteering)
View(tab.awa.disturb.data)
View(tab.awa.disturb.data)
View(tab.lu.disturb.data)
crithab.plot.data <- as.data.table (read.csv (here ("data/mackenzie/disturbance_by_crit_habitat.csv"),
header = T,
sep = ","))
View(crithab.plot.data)
knitr::opts_chunk$set(echo = TRUE)
library (keyring)
library (DBI)
library (RPostgreSQL)
library (sf)
library (raster)
library (exactextractr)
library (data.table)
library (units)
library (smoothr)
# library (rgrass7)
conn <- DBI::dbConnect (PostgreSQL(),
host = keyring::key_get('dbhost', keyring = 'postgreSQL'),
dbname = keyring::key_get('dbname', keyring = 'postgreSQL'),
port='5432',
user=keyring::key_get('dbuser', keyring = 'postgreSQL') ,
password= keyring::key_get('dbpass', keyring = 'postgreSQL'))
### Boundary data
## mackenzie timber supply area
sf.mac.tsa.bounds <- st_make_valid (st_read (dsn = "D:/tsr/mackenzie/data/mackenzie_tsa.shp"))
## elevation class data
sf.elev <- st_make_valid (st_read (dsn = "D:/tsr/mackenzie/data/elev1300.shp"))
sf.awa.mac <- st_make_valid (st_read (dsn = "D:/tsr/mackenzie/data/fwa_mac_poly.shp"))
sf.lu.mac <- st_make_valid (st_read (dsn = "D:/tsr/mackenzie/data/lu_mac_poly.shp"))
ras.roads.2020 <- raster ("D:/tsr/mackenzie/data/Current_Roads2020.tif")
ras.roads.2020 <- raster::reclassify (ras.roads.2020, c (1,3,1, 4,Inf,0)) # reclass
## future simulated roads
ras.roads.sim <- raster ("D:/tsr/mackenzie/data/road_state_7.tif")
ras.roads.sim <- ras.roads.sim - 329 # changes value to decade of development
ras.roads.sim <- raster::reclassify (ras.roads.sim, c (-Inf,0,0))
## all roads
ras.roads.all <- ras.roads.sim + ras.roads.2020
## existing fires
ras.fire.current <- raster ("D:/tsr/mackenzie/data/tsa16_fire_age.tif")
## future burned areas
ras.fire.sim <- raster ("D:/tsr/mackenzie/data/Disturbed_1_7.tif")
ras.fire.sim <- ras.fire.sim - 329 # changes value to decade of fire
ras.fire.sim <- raster::reclassify (ras.fire.sim, c (-Inf,0,0))
## existing cutblocks
ras.cut.current <- raster ("D:/tsr/mackenzie/data/tsa16_cutblock_age.tif")
## future logged areas
ras.cut.sim <- raster ("D:/tsr/mackenzie/data/Logged_1_7.tif")
ras.cut.sim <- ras.cut.sim - 329 # changes value to decade of logging
ras.cut.sim <- raster::reclassify (ras.cut.sim, c (-Inf,0,0))
ras.2020.disturb <- raster ("D:\\tsr\\mackenzie\\data\\ras_disturb_2020.tif")
ras.2030.disturb <- raster ("D:\\tsr\\mackenzie\\data\\ras_disturb_2030.tif")
ras.2040.disturb <- raster ("D:\\tsr\\mackenzie\\data\\ras_disturb_2040.tif")
ras.2050.disturb <- raster ("D:\\tsr\\mackenzie\\data\\ras_disturb_2050.tif")
ras.2060.disturb <- raster ("D:\\tsr\\mackenzie\\data\\ras_disturb_2060.tif")
ras.2070.disturb <- raster ("D:\\tsr\\mackenzie\\data\\ras_disturb_2070.tif")
ras.2080.disturb <- raster ("D:\\tsr\\mackenzie\\data\\ras_disturb_2080.tif")
ras.2090.disturb <- raster ("D:\\tsr\\mackenzie\\data\\ras_disturb_2090.tif")
# get lu's and awa's in critical habitat only
sf.hab.lu.mac <- st_make_valid (sf::st_intersection (sf.bc.crit.mac, sf.lu.mac))
## caribou critical habitat
sf.bc.crit <- st_make_valid (st_read (conn,
query = "SELECT * from bc_critical_habitat_all_herds_20200615;")
)
sf.bc.crit.mac <- st_make_valid (sf::st_intersection (sf.mac.tsa.bounds, sf.bc.crit)) # in mackenzie only
rm (sf.bc.crit)
# get lu's and awa's in critical habitat only
sf.hab.lu.mac <- st_make_valid (sf::st_intersection (sf.bc.crit.mac, sf.lu.mac))
sf.hab.awa.mac <- st_make_valid (sf::st_intersection (sf.bc.crit.mac, sf.awa.mac))
# add elevation class (1,300m)
sf.hab.lu.mac.elev <- st_make_valid (sf::st_intersection (sf.hab.lu.mac, sf.elev))
sf.hab.awa.mac.elev <- st_make_valid (sf::st_intersection (sf.hab.awa.mac, sf.elev))
# some geometry issues; this fixes them
sf.hab.lu.mac.elev <- st_cast (sf.hab.lu.mac.elev, "GEOMETRYCOLLECTION") %>% st_collection_extract ("POLYGON")
sf.hab.awa.mac.elev <- st_cast (sf.hab.awa.mac, "GEOMETRYCOLLECTION") %>% st_collection_extract ("POLYGON")
# add elevation class (1,300m)
sf.hab.mac.elev <- st_make_valid (sf::st_intersection (sf.bc.crit.mac, sf.elev))
sf.hab.mac.elev <- st_cast (sf.hab.mac.elev, "GEOMETRYCOLLECTION") %>% st_collection_extract ("POLYGON")
## ELEVATION ##
sf.hab.mac.elev$disturb_ha_2020 <- exactextractr::exact_extract (ras.2020.disturb,
sf.hab.mac.elev,
'sum')
sf.hab.mac.elev$disturb_ha_2030 <- exactextractr::exact_extract (ras.2030.disturb,
sf.hab.mac.elev,
'sum')
sf.hab.mac.elev$disturb_ha_2040 <- exactextractr::exact_extract (ras.2040.disturb,
sf.hab.mac.elev,
'sum')
plot (sf.hab.mac.elev)
plot (sf.hab.mac.elev$geometry)
st_write (sf.hab.mac.elev, dsn = "D:/tsr/mackenzie/data/hab_elev_mac_poly.shp")
## elevation class data
sf.elev <- st_make_valid (st_read (dsn = "D:/tsr/mackenzie/data/elev_1300.shp"))
# add elevation class (1,300m)
sf.hab.mac.elev <- st_make_valid (sf::st_intersection (sf.bc.crit.mac, sf.elev))
sf.hab.mac.elev <- st_cast (sf.hab.mac.elev, "GEOMETRYCOLLECTION") %>% st_collection_extract ("POLYGON")
## ELEVATION ##
sf.hab.mac.elev$disturb_ha_2020 <- exactextractr::exact_extract (ras.2020.disturb,
sf.hab.mac.elev,
'sum')
sf.hab.mac.elev$disturb_ha_2030 <- exactextractr::exact_extract (ras.2030.disturb,
sf.hab.mac.elev,
'sum')
plot (sf.hab.mac.elev$geometry)
sf.hab.mac.elev$disturb_ha_2040 <- exactextractr::exact_extract (ras.2040.disturb,
sf.hab.mac.elev,
'sum')
sf.hab.mac.elev$disturb_ha_2050 <- exactextractr::exact_extract (ras.2050.disturb,
sf.hab.mac.elev,
'sum')
sf.hab.mac.elev$disturb_ha_2060 <- exactextractr::exact_extract (ras.2060.disturb,
sf.hab.mac.elev,
'sum')
sf.hab.mac.elev$disturb_ha_2070 <- exactextractr::exact_extract (ras.2070.disturb,
sf.hab.mac.elev,
'sum')
sf.hab.mac.elev$disturb_ha_2080 <- exactextractr::exact_extract (ras.2080.disturb,
sf.hab.mac.elev,
'sum')
sf.hab.mac.elev$disturb_ha_2090 <- exactextractr::exact_extract (ras.2090.disturb,
sf.hab.mac.elev,
'sum')
# calculate area of polys
sf.hab.mac.elev$calc_area_m2 <- st_area (sf.hab.mac.elev)
# drop geometry, calculate area in ha's and subset data
disturb.hab.elev.mac <- as.data.table (sf::st_drop_geometry (sf.hab.mac.elev))
disturb.hab.elev.mac$calc_area_ha <- disturb.hab.elev.mac$calc_area_m2 * 0.0001
disturb.hab.elev.mac$calc_area_ha <- units::drop_units (disturb.hab.elev.mac$calc_area_ha)
disturb.hab.elev.mac$herd_elev <- paste0 (disturb.hab.elev.mac$herd_name,
sep = "_",
disturb.hab.elev.mac$elev
)
View(disturb.hab.elev.mac)
disturb.hab.mac <- disturb.hab.mac [, c ('TSA_NUMB_1', 'herd_name', 'bc_habitat_type', 'bchab_code', 'herd_elev ', 'calc_area_ha', 'disturb_ha_2020', 'disturb_ha_2030', 'disturb_ha_2040', 'disturb_ha_2050', 'disturb_ha_2060', 'disturb_ha_2070', 'disturb_ha_2080', 'disturb_ha_2090')]
disturb.hab.elev.mac <- disturb.hab.elev.mac [, c ('TSA_NUMB_1', 'herd_name', 'bc_habitat_type', 'bchab_code', 'herd_elev ', 'calc_area_ha', 'disturb_ha_2020', 'disturb_ha_2030', 'disturb_ha_2040', 'disturb_ha_2050', 'disturb_ha_2060', 'disturb_ha_2070', 'disturb_ha_2080', 'disturb_ha_2090')]
disturb.hab.elev.mac$herd_elev <- paste0 (disturb.hab.elev.mac$herd_name,
sep = "_",
disturb.hab.elev.mac$elev
)
disturb.hab.elev.mac <- disturb.hab.elev.mac [, c ('TSA_NUMB_1', 'herd_name', 'bc_habitat_type', 'bchab_code', 'herd_elev ', 'calc_area_ha', 'disturb_ha_2020', 'disturb_ha_2030', 'disturb_ha_2040', 'disturb_ha_2050', 'disturb_ha_2060', 'disturb_ha_2070', 'disturb_ha_2080', 'disturb_ha_2090')]
disturb.hab.elev.mac <- disturb.hab.elev.mac [, c ('TSA_NUMB_1', 'herd_name', 'bc_habitat_type', 'bchab_code', 'herd_elev', 'calc_area_ha', 'disturb_ha_2020', 'disturb_ha_2030', 'disturb_ha_2040', 'disturb_ha_2050', 'disturb_ha_2060', 'disturb_ha_2070', 'disturb_ha_2080', 'disturb_ha_2090')]
# summarize by elevation
disturb.hab.mac <- disturb.hab.mac [, .(disturb_ha_2020 = sum (disturb_ha_2020),
disturb_ha_2030 = sum (disturb_ha_2030),
disturb_ha_2040 = sum (disturb_ha_2040),
disturb_ha_2050 = sum (disturb_ha_2050),
disturb_ha_2060 = sum (disturb_ha_2060),
disturb_ha_2070 = sum (disturb_ha_2070),
disturb_ha_2080 = sum (disturb_ha_2080),
disturb_ha_2090 = sum (disturb_ha_2090),
calc_area_ha = sum (calc_area_ha) ), by = .(herd_elev)]
# summarize by elevation
disturb.hab.elev.mac <- disturb.hab.elev.mac [, .(disturb_ha_2020 = sum (disturb_ha_2020),
disturb_ha_2030 = sum (disturb_ha_2030),
disturb_ha_2040 = sum (disturb_ha_2040),
disturb_ha_2050 = sum (disturb_ha_2050),
disturb_ha_2060 = sum (disturb_ha_2060),
disturb_ha_2070 = sum (disturb_ha_2070),
disturb_ha_2080 = sum (disturb_ha_2080),
disturb_ha_2090 = sum (disturb_ha_2090),
calc_area_ha = sum (calc_area_ha) ), by = .(herd_elev)]
disturb.hab.elev.mac [, perc_disturb_2020 := (disturb_ha_2020 / calc_area_ha)*100]
disturb.hab.elev.mac [, perc_disturb_2030 := (disturb_ha_2030 / calc_area_ha)*100]
disturb.hab.elev.mac [, perc_disturb_2040 := (disturb_ha_2040 / calc_area_ha)*100]
disturb.hab.elev.mac [, perc_disturb_2050 := (disturb_ha_2050 / calc_area_ha)*100]
disturb.hab.elev.mac [, perc_disturb_2060 := (disturb_ha_2060 / calc_area_ha)*100]
disturb.hab.elev.mac [, perc_disturb_2070 := (disturb_ha_2070 / calc_area_ha)*100]
disturb.hab.elev.mac [, perc_disturb_2080 := (disturb_ha_2080 / calc_area_ha)*100]
disturb.hab.elev.mac [, perc_disturb_2090 := (disturb_ha_2090 / calc_area_ha)*100]
write.table (disturb.hab.elev.mac,
file = "D:\\tsr\\mackenzie\\data\\disturbance_by_herd_elev.csv",
sep = ",")
herd.elev.plot.data <- as.data.table (read.csv (here ("data/mackenzie/disturbance_by_herd_elev.csv"),
header = T,
sep = ","))
here ()
herd.elev.plot.data <- as.data.table (read.csv (here ("data/mackenzie/disturbance_by_herd_elev.csv"),
header = T,
sep = ","))
## Re-shape the data ##
herd.elev.plot.data <- melt.data.table (herd.elev.plot.data,
id.vars = "herd_elev",
measure.vars = c("perc_disturb_2020", "perc_disturb_2030", "perc_disturb_2040",
"perc_disturb_2050", "perc_disturb_2060", "perc_disturb_2070",
"perc_disturb_2080", "perc_disturb_2090")
)
herd.elev.plot.data$variable <- as.character (herd.elev.plot.data$variable)
herd.elev.plot.data [herd.elev.plot.data == "perc_disturb_2020"] <- "2020"
herd.elev.plot.data [herd.elev.plot.data == "perc_disturb_2030"] <- "2030"
herd.elev.plot.data [herd.elev.plot.data == "perc_disturb_2040"] <- "2040"
herd.elev.plot.data [herd.elev.plot.data == "perc_disturb_2050"] <- "2050"
herd.elev.plot.data [herd.elev.plot.data == "perc_disturb_2060"] <- "2060"
herd.elev.plot.data [herd.elev.plot.data == "perc_disturb_2070"] <- "2070"
herd.elev.plot.data [herd.elev.plot.data == "perc_disturb_2080"] <- "2080"
herd.elev.plot.data [herd.elev.plot.data == "perc_disturb_2090"] <- "2090"
herd.elev.plot.data$Year <- as.numeric (herd.elev.plot.data$variable)
View(herd.elev.plot.data)
unique (herd.elev.plot.data$herd_elev)
# subset northern herds high elevation
herd.hi.elev.plot.data.nrth <- subset (herd.elev.plot.data, herd_elev == "Chase_>1300m" |  herd_elev == "Finlay_>1300m" |  herd_elev == "Frog_>1300m" |  herd_elev == "Gataga_>1300m" | herd_elev == "Rabbit_>1300m" |  herd_elev == "Spatsizi_>1300m" |   herd_elev == "Thutade_>1300m" |  herd_elev == "Wolverine_>1300m" |  herd_elev == "Muskwa_>1300m" |  herd_elev == "Scott_>1300m" |  herd_elev == "Pink_Mountain_>1300m" )
ggplot (data = herd.hi.elev.plot.data.nrth,
aes (x = Year, y = value, col = herd_elev)) +
geom_line (aes (linetype = herd_elev), size = 1) +
xlab ("Year") + ylab ("Percent Disturbance") +
scale_x_continuous (limits = c (2020, 2090), breaks = seq (2020, 2090, by = 10)) +
scale_y_continuous (limits = c (0, 100), breaks = seq (0, 100, by = 10)) +
ggtitle ("Northern Caribou Range Simulated Disturbance at High Elevation (>1,300m)") +
theme (axis.text = element_text (size = 10),
axis.title = element_text (size = 12),
axis.line.x = element_line (size = 1),
axis.line.y = element_line (size = 1),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "bottom",
legend.key = element_rect (fill = NA)) +
scale_linetype_discrete (name = "Herd Name",
breaks = c ("Chase_>1300m", "Finlay_>1300m", "Frog_>1300m",
"Gataga_>1300m",  "Rabbit_>1300m", "Spatsizi_>1300m",
"Thutade_>1300m", "Wolverine_>1300m", "Muskwa_>1300m",
"Scott_>1300m", "Pink_Mountain_>1300m"),
labels = c ("Chase", "Finlay", "Frog", "Gataga",
"Rabbit", "Spatsizi", "Thutade",
"Wolverine", "Muskwa", "Scott", "Pink Mountain"),
guide = guide_legend (ncol = 3)) +
scale_colour_discrete (name = "Herd Name",
breaks = c ("Chase_>1300m", "Finlay_>1300m", "Frog_>1300m",
"Gataga_>1300m",  "Rabbit_>1300m", "Spatsizi_>1300m",
"Thutade_>1300m", "Wolverine_>1300m", "Muskwa_>1300m",
"Scott_>1300m", "Pink_Mountain_>1300m"),
labels = c ("Chase", "Finlay", "Frog", "Gataga",
"Rabbit", "Spatsizi", "Thutade",
"Wolverine", "Muskwa", "Scott", "Pink Mountain"),
guide = guide_legend (ncol = 3))
ggplot (data = herd.hi.elev.plot.data.nrth,
aes (x = Year, y = value, col = herd_elev)) +
geom_line (aes (linetype = herd_elev), size = 1) +
xlab ("Year") + ylab ("Percent Disturbance") +
scale_x_continuous (limits = c (2020, 2090), breaks = seq (2020, 2090, by = 10)) +
scale_y_continuous (limits = c (0, 100), breaks = seq (0, 100, by = 10)) +
ggtitle ("Northern Caribou Range Simulated Disturbance at High Elevation (>1,300m)") +
theme (axis.text = element_text (size = 10),
axis.title = element_text (size = 12),
axis.line.x = element_line (size = 1),
axis.line.y = element_line (size = 1),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "bottom",
legend.key = element_rect (fill = NA)) +
scale_linetype_discrete (name = "Herd Name",
breaks = c ("Chase_>1300m", "Finlay_>1300m", "Frog_>1300m",
"Gataga_>1300m",  "Rabbit_>1300m", "Spatsizi_>1300m",
"Thutade_>1300m", "Wolverine_>1300m", "Muskwa_>1300m",
"Scott_>1300m", "Pink_Mountain_>1300m"),
labels = c ("Chase", "Finlay", "Frog", "Gataga",
"Rabbit", "Spatsizi", "Thutade",
"Wolverine", "Muskwa", "Scott", "Pink Mountain"),
guide = guide_legend (ncol = 3)) +
scale_colour_discrete (name = "Herd Name",
breaks = c ("Chase_>1300m", "Finlay_>1300m", "Frog_>1300m",
"Gataga_>1300m",  "Rabbit_>1300m", "Spatsizi_>1300m",
"Thutade_>1300m", "Wolverine_>1300m", "Muskwa_>1300m",
"Scott_>1300m", "Pink_Mountain_>1300m"),
labels = c ("Chase", "Finlay", "Frog", "Gataga",
"Rabbit", "Spatsizi", "Thutade",
"Wolverine", "Muskwa", "Scott", "Pink Mountain"),
guide = guide_legend (ncol = 3))
View(herd.hi.elev.plot.data.nrth)
# subset northern herds
herd.lo.elev.plot.data.nrth <- subset (herd.elev.plot.data, herd_elev == "Chase_<=1300m" |  herd_elev == "Finlay_<=1300m" |  herd_elev == "Frog_<=1300m" |  herd_elev == "Gataga_<=1300m" |  herd_elev == "Rabbit_<=1300m" |  herd_elev == "Spatsizi_<=1300m" |  herd_elev == "Thutade_<=1300m" |  herd_elev == "Wolverine_<=1300m" |  herd_elev == "Muskwa_<=1300m" |  herd_elev == "Thutade_<=1300m" |  herd_elev == "Scott_<=1300m")
ggplot (data = herd.lo.elev.plot.data.nrth,
aes (x = Year, y = value, col = herd_elev)) +
geom_line (aes (linetype = herd_elev), size = 1) +
xlab ("Year") + ylab ("Percent Disturbance") +
scale_x_continuous (limits = c (2020, 2090), breaks = seq (2020, 2090, by = 10)) +
scale_y_continuous (limits = c (0, 100), breaks = seq (0, 100, by = 10)) +
ggtitle ("Northern Caribou Range Simulated Disturbance at Low Elevation (<1,300m)") +
theme (axis.text = element_text (size = 10),
axis.title = element_text (size = 12),
axis.line.x = element_line (size = 1),
axis.line.y = element_line (size = 1),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "bottom",
legend.key = element_rect (fill = NA)) +
scale_linetype_discrete (name = "Herd Name",
breaks = c ("Chase_<=1300m", "Finlay_<=1300m", "Frog_<=1300m",
"Gataga_<=1300m",  "Rabbit_<=1300m", "Spatsizi_<=1300m",
"Thutade_<=1300m", "Wolverine_<=1300m", "Muskwa_<=1300m",
"Scott_<=1300m", "Pink_Mountain_<=1300m"),
labels = c ("Chase", "Finlay", "Frog", "Gataga",
"Rabbit", "Spatsizi", "Thutade",
"Wolverine", "Muskwa", "Scott", "Pink Mountain"),
guide = guide_legend (ncol = 3)) +
scale_colour_discrete (name = "Herd Name",
breaks = c ("Chase_<=1300m", "Finlay_<=1300m", "Frog_<=1300m",
"Gataga_<=1300m",  "Rabbit_<=1300m", "Spatsizi_<=1300m",
"Thutade_<=1300m", "Wolverine_<=1300m", "Muskwa_<=1300m",
"Scott_<=1300m", "Pink_Mountain_<=1300m"),
labels = c ("Chase", "Finlay", "Frog", "Gataga",
"Rabbit", "Spatsizi", "Thutade",
"Wolverine", "Muskwa", "Scott", "Pink Mountain"),
guide = guide_legend (ncol = 3))
ggplot (data = herd.lo.elev.plot.data.nrth,
aes (x = Year, y = value, col = herd_elev)) +
geom_line (aes (linetype = herd_elev), size = 1) +
xlab ("Year") + ylab ("Percent Disturbance") +
scale_x_continuous (limits = c (2020, 2090), breaks = seq (2020, 2090, by = 10)) +
scale_y_continuous (limits = c (0, 100), breaks = seq (0, 100, by = 10)) +
ggtitle ("Northern Caribou Range Simulated Disturbance at Low Elevation (<1,300m)") +
theme (axis.text = element_text (size = 10),
axis.title = element_text (size = 12),
axis.line.x = element_line (size = 1),
axis.line.y = element_line (size = 1),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "bottom",
legend.key = element_rect (fill = NA)) +
scale_linetype_discrete (name = "Herd Name",
breaks = c ("Chase_<=1300m", "Finlay_<=1300m", "Frog_<=1300m",
"Gataga_<=1300m",  "Rabbit_<=1300m", "Spatsizi_<=1300m",
"Thutade_<=1300m", "Wolverine_<=1300m", "Muskwa_<=1300m",
"Scott_<=1300m", "Pink_Mountain_<=1300m"),
labels = c ("Chase", "Finlay", "Frog", "Gataga",
"Rabbit", "Spatsizi", "Thutade",
"Wolverine", "Muskwa", "Scott", "Pink Mountain"),
guide = guide_legend (ncol = 3)) +
scale_colour_discrete (name = "Herd Name",
breaks = c ("Chase_<=1300m", "Finlay_<=1300m", "Frog_<=1300m",
"Gataga_<=1300m",  "Rabbit_<=1300m", "Spatsizi_<=1300m",
"Thutade_<=1300m", "Wolverine_<=1300m", "Muskwa_<=1300m",
"Scott_<=1300m", "Pink_Mountain_<=1300m"),
labels = c ("Chase", "Finlay", "Frog", "Gataga",
"Rabbit", "Spatsizi", "Thutade",
"Wolverine", "Muskwa", "Scott", "Pink Mountain"),
guide = guide_legend (ncol = 3))
View(herd.lo.elev.plot.data.nrth)
# load data
tab.lu.disturb.data <- as.data.table (read.csv (here ("data/mackenzie/disturbance_by_landscape_unit.csv"),
header = T,
sep = ","))
# join data
sf.lu <- dplyr::full_join (sf.lu, tab.lu.disturb.data, by = "LANDSCAP_2")
# build map
ggplot (data = sf.lu) +
geom_sf (aes (fill = perc_disturb_2030)) +
geom_sf (data = sf.caribou.herds, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
# geom_sf_label(data = sf.caribou.herds, aes(label = CARIBOU_TA)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Disturbance by Landscape Unit in 2030") +
scale_fill_viridis (option="inferno") +
guides (fill = guide_legend (title = "Percent of Landscape Unit Disturbed")) +
annotation_scale(location = "bl", width_hint = 0.5) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.1, "in"), pad_y = unit(0.2, "in"),
style = north_arrow_fancy_orienteering)
# load data
tab.lu.disturb.data <- as.data.table (read.csv (here ("data/mackenzie/disturbance_by_landscape_unit.csv"),
header = T,
sep = ","))
# join data
sf.lu <- dplyr::full_join (sf.lu, tab.lu.disturb.data, by = "LANDSCAP_2")
View(sf.lu)
# build map
ggplot (data = sf.lu) +
geom_sf (aes (fill = perc_disturb_2030)) +
geom_sf (data = sf.caribou.herds, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
# geom_sf_label(data = sf.caribou.herds, aes(label = CARIBOU_TA)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Disturbance by Landscape Unit in 2030") +
scale_fill_viridis (option="inferno") +
guides (fill = guide_legend (title = "Percent of Landscape Unit Disturbed")) +
annotation_scale(location = "bl", width_hint = 0.5) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.1, "in"), pad_y = unit(0.2, "in"),
style = north_arrow_fancy_orienteering)
# load data
tab.awa.disturb.data <- as.data.table (read.csv (here ("data/mackenzie/disturbance_by_watershed.csv"),
header = T,
sep = ","))
# join data
sf.awa <- dplyr::full_join (sf.awa, tab.awa.disturb.data, by = "WATERSHED_")
# build map
ggplot (data = sf.awa) +
geom_sf (aes (fill = perc_disturb_2030), color = NA) +
geom_sf (data = sf.caribou.herds, fill = NA, linetype = "longdash", size = 1.1, colour = "green")+
# geom_sf_label(data = sf.caribou.herds, aes(label = CARIBOU_TA)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Disturbance by Watershed Area in 2030") +
scale_fill_viridis (option="inferno") +
guides (fill = guide_legend (title = "Percent of Watershed Area Disturbed")) +
annotation_scale(location = "bl", width_hint = 0.5) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.1, "in"), pad_y = unit(0.2, "in"),
style = north_arrow_fancy_orienteering)
# load data
tab.awa.disturb.data <- as.data.table (read.csv (here ("data/mackenzie/disturbance_by_watershed.csv"),
header = T,
sep = ","))
# join data
sf.awa <- dplyr::full_join (sf.awa, tab.awa.disturb.data, by = "WATERSHED_")
# build map
ggplot (data = sf.awa) +
geom_sf (aes (fill = perc_disturb_2030), color = NA) +
geom_sf (data = sf.caribou.herds, fill = NA, linetype = "longdash", size = 1.1, colour = "green")+
# geom_sf_label(data = sf.caribou.herds, aes(label = CARIBOU_TA)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Disturbance by Watershed Area in 2030") +
scale_fill_viridis (option="inferno") +
guides (fill = guide_legend (title = "Percent of Watershed Area Disturbed")) +
annotation_scale(location = "bl", width_hint = 0.5) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.1, "in"), pad_y = unit(0.2, "in"),
style = north_arrow_fancy_orienteering)
# load data
tab.awa.disturb.data <- as.data.table (read.csv (here ("data/mackenzie/disturbance_by_watershed.csv"),
header = T,
sep = ","))
# join data
sf.awa <- dplyr::full_join (sf.awa, tab.awa.disturb.data, by = "WATERSHED_")
# join data
sf.awa <- dplyr::full_join (sf.awa, tab.awa.disturb.data, by = "WATERSHED_")
sf.awa <- st_make_valid (st_read (dsn = here ("data/mackenzie/fwa_mac_poly.shp")))
sf.lu <- st_make_valid (st_read (dsn = here ("data/mackenzie/lu_mac_poly.shp")))
# load data
tab.lu.disturb.data <- as.data.table (read.csv (here ("data/mackenzie/disturbance_by_landscape_unit.csv"),
header = T,
sep = ","))
# join data
sf.lu <- dplyr::full_join (sf.lu, tab.lu.disturb.data, by = "LANDSCAP_2")
# build map
ggplot (data = sf.lu) +
geom_sf (aes (fill = perc_disturb_2030)) +
geom_sf (data = sf.caribou.herds, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
# geom_sf_label(data = sf.caribou.herds, aes(label = CARIBOU_TA)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Disturbance by Landscape Unit in 2030") +
scale_fill_viridis (option="inferno") +
guides (fill = guide_legend (title = "Percent of Landscape Unit Disturbed")) +
annotation_scale(location = "bl", width_hint = 0.5) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.1, "in"), pad_y = unit(0.2, "in"),
style = north_arrow_fancy_orienteering)
# load spatial data
sf.caribou.herds <- st_make_valid (st_read (dsn = here ("data/mackenzie/mackenzie_caribou_herds.shp")))
sf.caribou.herds <- sf.caribou.herds %>% # this combines the two Scott polys into one
group_by (CARIBOU_TA) %>%
summarise ()
# build map
ggplot (data = sf.lu) +
geom_sf (aes (fill = perc_disturb_2030)) +
geom_sf (data = sf.caribou.herds, fill = NA, linetype = "longdash", size = 1.1, colour = "green") +
# geom_sf_label(data = sf.caribou.herds, aes(label = CARIBOU_TA)) +
xlab("Longitude") + ylab("Latitude") +
ggtitle ("Disturbance by Landscape Unit in 2030") +
scale_fill_viridis (option="inferno") +
guides (fill = guide_legend (title = "Percent of Landscape Unit Disturbed")) +
annotation_scale(location = "bl", width_hint = 0.5) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.1, "in"), pad_y = unit(0.2, "in"),
style = north_arrow_fancy_orienteering)
