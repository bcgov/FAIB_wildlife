plot (ras.roads.1980)
ras.roads.1990 <- raster::reclassify (ras.roads.hist, # all roads before 1990
c (-1,10,1, 10,Inf,0))
plot (ras.roads.1990)
plot (ras.roads.1980)
plot (ras.roads.1990)
ras.roads.2000 <- raster::reclassify (ras.roads.hist, # all roads before 2000
c (-1,20,1, 20,Inf,0))
ras.roads.2010 <- raster::reclassify (ras.roads.hist, # all roads before 2010
c (-1,30,1, 30,Inf,0))
plot (ras.roads.1980)
plot (ras.roads.1990)
plot (ras.roads.2000)
plot (ras.roads.2010)
## existing cutblocks
ras.cut.current <- raster ("D:/tsr/mackenzie/data/tsa16_cutblock_age.tif")
# Cutblocks
ras.cut.current <- raster ("D:/tsr/mackenzie/data/tsa16_cutblock_age.tif")
plot (ras.cut.current)
ras.cut.1980 <- raster::reclassify (ras.cut.current, # all cutblocks before 1980
c (1,40,1, 40,Inf,0))
plot (ras.cut.1980)
ras.cut.1980 <- raster::reclassify (ras.cut.current, # all cutblocks before 1980
c (41,Inf,1, 0,40,0))
plot (ras.cut.1980)
ras.cut.1990 <- raster::reclassify (ras.cut.current, # all cutblocks before 1990
c (31,Inf,1, 0,30,0))
plot (ras.cut.1980)
plot (ras.cut.1990)
writeRaster (ras.cut.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.1990, "D:\\tsr\\mackenzie\\data\\ras_cut_1990.tif", format = "GTiff", overwrite=TRUE)
ras.cut.2000 <- raster::reclassify (ras.cut.current, # all cutblocks before 2000
c (21,Inf,1, 0,20,0))
writeRaster (ras.cut.2000, "D:\\tsr\\mackenzie\\data\\ras_cut_2000.tif", format = "GTiff", overwrite=TRUE)
ras.cut.2010 <- raster::reclassify (ras.cut.current, # all cutblocks before 2010
c (11,Inf,1, 0,10,0))
# add cutblocks and roads together
ras.cut.road.1980 <- ras.roads.1980 + ras.cut.1980
ras.cut.road.1990 <- ras.roads.1990 + ras.cut.1990
ras.cut.road.2000 <- ras.roads.2000 + ras.cut.2000
ras.cut.road.2000 <- ras.roads.2000 + ras.cut.2000
ras.cut.road.2010 <- ras.roads.2010 + ras.cut.2010
ras.cut.road.1980 [ras.cut.road.1980 > 1] <- 1 # reclass
ras.cut.road.1990 [ras.cut.road.1990 > 1] <- 1 # reclass
ras.cut.road.2000 [ras.cut.road.2000 > 1] <- 1 # reclass
ras.cut.road.2010 [ras.cut.road.2010 > 1] <- 1 # reclass
plot (ras.cut.road.1980)
plot (ras.cut.road.1990)
plot (ras.cut.road.2000)
plot (ras.cut.road.2010)
writeRaster (ras.cut.road.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.1990, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2000, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2010, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2010.tif", format = "GTiff", overwrite=TRUE)
ras.roads.1980 <- raster::reclassify (ras.roads.hist, # all roads before 1980
c (Inf,0,1, 0,Inf,0))
ras.roads.1980 <- raster::reclassify (ras.roads.hist, # all roads before 1980
c (-Inf,0,1, 0,Inf,0))
ras.roads.1990 <- raster::reclassify (ras.roads.hist, # all roads before 1990
c (-Inf,10,1, 10,Inf,0))
ras.roads.2000 <- raster::reclassify (ras.roads.hist, # all roads before 2000
c (-Inf,20,1, 20,Inf,0))
ras.roads.2010 <- raster::reclassify (ras.roads.hist, # all roads before 2010
c (-Inf,30,1, 30,Inf,0))
ras.cut.1980 <- raster::reclassify (ras.cut.current, # all cutblocks before 1980
c (41,Inf,1, 0,40,0))
# add cutblocks and roads together
ras.cut.road.1980 <- ras.roads.1980 + ras.cut.1980
ras.cut.road.1990 <- ras.roads.1990 + ras.cut.1990
ras.cut.road.2000 <- ras.roads.2000 + ras.cut.2000
ras.cut.road.2010 <- ras.roads.2010 + ras.cut.2010
ras.cut.road.1980 [ras.cut.road.1980 > 1] <- 1 # reclass
ras.cut.road.1990 [ras.cut.road.1990 > 1] <- 1 # reclass
ras.cut.road.2000 [ras.cut.road.2000 > 1] <- 1 # reclass
ras.cut.road.2010 [ras.cut.road.2010 > 1] <- 1 # reclass
writeRaster (ras.cut.road.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.1990, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.1990, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2000, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.1990, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2000, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2010, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2010.tif", format = "GTiff", overwrite=TRUE)
plot (roads.rast.hist)
# Roads
ras.roads.hist <- raster ("D:/tsr/mackenzie/data/MacKenzie_TSA_roads_1980_2020.tif")
plot (roads.rast.hist)
plot (ras.roads.hist)
ras.roads.1980 <- raster::reclassify (ras.roads.hist, # all roads before 1980
c (-Inf,0,1, 0,Inf,0))
plot (ras.roads.1980)
writeRaster (ras.roads.1980, "D:\\tsr\\mackenzie\\data\\ras_roads_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.1990, "D:\\tsr\\mackenzie\\data\\ras_cut_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.2000, "D:\\tsr\\mackenzie\\data\\ras_cut_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.2010, "D:\\tsr\\mackenzie\\data\\ras_cut_2010.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.roads.1990, "D:\\tsr\\mackenzie\\data\\ras_roads_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.roads.2000, "D:\\tsr\\mackenzie\\data\\ras_roads_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.roads.2010, "D:\\tsr\\mackenzie\\data\\ras_roads_2010.tif", format = "GTiff", overwrite=TRUE)
ras.cut.1980 <- raster::reclassify (ras.cut.current, # all cutblocks before 1980
c (40,Inf,1, 0,40,0))
ras.cut.1980 <- raster::reclassify (ras.cut.current, # all cutblocks before 1980
c (40,Inf,1, 0,40,0))
ras.cut.1990 <- raster::reclassify (ras.cut.current, # all cutblocks before 1990
c (30,Inf,1, 0,30,0))
ras.cut.1980 <- raster::reclassify (ras.cut.current, # all cutblocks before 1980
c (40,Inf,1, 0,40,0))
ras.cut.1990 <- raster::reclassify (ras.cut.current, # all cutblocks before 1990
c (30,Inf,1, 0,30,0))
ras.cut.2000 <- raster::reclassify (ras.cut.current, # all cutblocks before 2000
c (20,Inf,1, 0,20,0))
ras.cut.2000 <- raster::reclassify (ras.cut.current, # all cutblocks before 2000
c (20,Inf,1, 0,20,0))
ras.cut.2010 <- raster::reclassify (ras.cut.current, # all cutblocks before 2010
c (10,Inf,1, 0,10,0))
writeRaster (ras.cut.1990, "D:\\tsr\\mackenzie\\data\\ras_cut_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.2000, "D:\\tsr\\mackenzie\\data\\ras_cut_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.2010, "D:\\tsr\\mackenzie\\data\\ras_cut_2010.tif", format = "GTiff", overwrite=TRUE)
# add cutblocks and roads together
ras.cut.road.1980 <- ras.roads.1980 + ras.cut.1980
ras.cut.road.2000 <- ras.roads.2000 + ras.cut.2000
ras.cut.road.2000 <- ras.roads.2000 + ras.cut.2000
ras.cut.road.2010 <- ras.roads.2010 + ras.cut.2010
ras.cut.road.2010 <- ras.roads.2010 + ras.cut.2010
ras.cut.road.1980 [ras.cut.road.1980 > 1] <- 1 # reclass
ras.cut.road.1980 [ras.cut.road.1980 > 1] <- 1 # reclass
ras.cut.road.1990 [ras.cut.road.1990 > 1] <- 1 # reclass
ras.cut.road.2000 [ras.cut.road.2000 > 1] <- 1 # reclass
ras.cut.road.2000 [ras.cut.road.2000 > 1] <- 1 # reclass
ras.cut.road.2010 [ras.cut.road.2010 > 1] <- 1 # reclass
plot ()ras.cut.road.1980
plot (ras.cut.road.1980)
plot (ras.cut.road.1990)
plot (ras.cut.road.2000)
plot (ras.cut.road.2010)
writeRaster (ras.cut.road.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.1990, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2000, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2010, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2010.tif", format = "GTiff", overwrite=TRUE)
plot (ras.cut.1980)
plot (ras.cut.road.1980)
# add cutblocks and roads together
ras.cut.road.1980 <- ras.roads.1980 + ras.cut.1980
plot (ras.cut.road.1980)
writeRaster (ras.cut.road.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1980.tif", format = "GTiff", overwrite=TRUE)
plot (ras.cut.current)
# Cutblocks
ras.cut.current <- raster ("D:/tsr/mackenzie/data/tsa16_cutblock_age.tif")
ras.cut.1980 <- raster::reclassify (ras.cut.current, # all cutblocks before 1980
c (40,Inf,1, 0,40,0))
plot (ras.cut.current)
ras.cut.1980 <- raster::reclassify (ras.cut.current, # all cutblocks 1940-1980
c (40,80,1, 0,40,0, 80,Inf,0))
ras.cut.1990 <- raster::reclassify (ras.cut.current, # all cutblocks 1950-1990
c (30,70,1, 0,30,0, 70,Inf,0))
ras.cut.2000 <- raster::reclassify (ras.cut.current, # all cutblocks 1960-2000
c (20,60,1, 0,20,0, 60,Inf,0))
ras.cut.2010 <- raster::reclassify (ras.cut.current, # all cutblocks 1970-2010
c (10,50,1, 0,10,0, 50,Inf,0))
plot (ras.cut.1980)
plot (ras.cut.1990)
plot (ras.cut.2000)
plot (ras.cut.2010)
writeRaster (ras.cut.1990, "D:\\tsr\\mackenzie\\data\\ras_cut_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.2000, "D:\\tsr\\mackenzie\\data\\ras_cut_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.2010, "D:\\tsr\\mackenzie\\data\\ras_cut_2010.tif", format = "GTiff", overwrite=TRUE)
plot (ras.roads.1980)
# add cutblocks and roads together
ras.cut.road.1980 <- ras.roads.1980 + ras.cut.1980
writeRaster (ras.cut.road.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1980.tif", format = "GTiff", overwrite=TRUE)
## 2020 (current)
m <- c (1,40,1, 40,Inf,0) # matrix to make 1 to 40 pixels = 1, else = 0
ras.cut.current.40  <- raster::reclassify (ras.cut.current, # class of 40 year-old cutblocks
m)
writeRaster (ras.cut.current.40, "D:\\tsr\\mackenzie\\data\\ras_cut_2020.tif", format = "GTiff", overwrite=TRUE)
### Disturbance Data
## current roads
ras.roads.2020 <- raster ("D:/tsr/mackenzie/data/Current_Roads2020.tif")
ras.roads.2020 <- raster::reclassify (ras.roads.2020, c (1,3,1, 4,Inf,0)) # reclass
writeRaster (ras.roads.2020, "D:\\tsr\\mackenzie\\data\\ras_roads_2020.tif", format = "GTiff", overwrite=TRUE)
ras.cut.road <- ras.cut.current.40 + ras.roads.2020 # disturbances that need a buffer
#ras.cut.road [ras.cut.road == 0] <- NA # make 0's NA's for buffering
ras.cut.road [ras.cut.road > 1] <- 1 # reclass
# add cutblocks and roads together
ras.cut.road.1980 <- ras.cut.1980 + ras.roads.1980
ras.cut.1980.2 <- resample (ras.cut.1980, ras.roads.1980, "bilinear")
plot (ras.cut.1980.2)
writeRaster (ras.cut.1980.2, "D:\\tsr\\mackenzie\\data\\ras_cut_1980_2.tif", format = "GTiff", overwrite=TRUE)
# rasters have different extents; re-sample them to be consistent
ras.cut.1980 <- resample (ras.cut.1980, ras.roads.1980, "bilinear")
ras.cut.1990 <- resample (ras.cut.1990, ras.roads.1990, "bilinear")
ras.cut.2000 <- resample (ras.cut.2000, ras.roads.2000, "bilinear")
ras.cut.2010 <- resample (ras.cut.2010, ras.roads.2010, "bilinear")
# add cutblocks and roads together
ras.cut.road.1980 <- ras.cut.1980 + ras.roads.1980
ras.cut.road.1990 <- ras.roads.1990 + ras.cut.1990
ras.cut.road.2000 <- ras.roads.2000 + ras.cut.2000
ras.cut.road.2010 <- ras.roads.2010 + ras.cut.2010
ras.cut.road.1980 [ras.cut.road.1980 > 1] <- 1 # reclass
ras.cut.road.1990 [ras.cut.road.1990 > 1] <- 1 # reclass
ras.cut.road.2000 [ras.cut.road.2000 > 1] <- 1 # reclass
ras.cut.road.2010 [ras.cut.road.2010 > 1] <- 1 # reclass
writeRaster (ras.cut.road.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.1990, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2000, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2010, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2010.tif", format = "GTiff", overwrite=TRUE)
extent (ras.cut.1980)
extent (ras.roads.1980)
extent (ras.cut.road.1980)
# add cutblocks and roads together
ras.cut.road.1980 <- ras.cut.1980 + ras.roads.1980
ras.cut.road.1990 <- ras.roads.1990 + ras.cut.1990
ras.cut.road.2000 <- ras.roads.2000 + ras.cut.2000
ras.cut.road.2010 <- ras.roads.2010 + ras.cut.2010
plot (ras.cut.road.1980)
plot (ras.cut.road.1990)
plot (ras.cut.1980)
ras.roads.1980 <- raster::reclassify (ras.roads.hist, # all roads before 1980
c (NA,NA, 0, -Inf,0,1, 0,Inf,0))
ras.roads.1990 <- raster::reclassify (ras.roads.hist, # all roads before 1990
c (NA,NA, 0, -Inf,10,1, 10,Inf,0))
ras.roads.2000 <- raster::reclassify (ras.roads.hist, # all roads before 2000
c (-Inf,20,1, 20,Inf,0))
ras.roads.2010 <- raster::reclassify (ras.roads.hist, # all roads before 2010
c (-Inf,30,1, 30,Inf,0))
ras.cut.1980 <- raster::reclassify (ras.cut.current, # all cutblocks 1940-1980
c (NA,NA, 0, 40,80,1, 0,40,0, 80,Inf,0))
ras.cut.1990 <- raster::reclassify (ras.cut.current, # all cutblocks 1950-1990
c (NA,NA, 0, 30,70,1, 0,30,0, 70,Inf,0))
ras.cut.2000 <- raster::reclassify (ras.cut.current, # all cutblocks 1960-2000
c (NA,NA, 0, 20,60,1, 0,20,0, 60,Inf,0))
ras.cut.2010 <- raster::reclassify (ras.cut.current, # all cutblocks 1970-2010
c (NA,NA, 0, 10,50,1, 0,10,0, 50,Inf,0))
# rasters have different extents; re-sample them to be consistent
ras.cut.1980 <- resample (ras.cut.1980, ras.roads.1980, "bilinear")
ras.cut.1990 <- resample (ras.cut.1990, ras.roads.1990, "bilinear")
ras.cut.1990 <- resample (ras.cut.1990, ras.roads.1990, "bilinear")
ras.cut.2000 <- resample (ras.cut.2000, ras.roads.2000, "bilinear")
ras.cut.2010 <- resample (ras.cut.2010, ras.roads.2010, "bilinear")
# add cutblocks and roads together
ras.cut.road.1980 <- ras.roads.1980 + ras.cut.1980
ras.cut.road.1990 <- ras.roads.1990 + ras.cut.1990
ras.cut.road.2000 <- ras.roads.2000 + ras.cut.2000
ras.cut.road.2010 <- ras.roads.2010 + ras.cut.2010
ras.cut.road.1980 [ras.cut.road.1980 > 1] <- 1 # reclass
ras.cut.road.1990 [ras.cut.road.1990 > 1] <- 1 # reclass
ras.cut.road.2000 [ras.cut.road.2000 > 1] <- 1 # reclass
ras.cut.road.2010 [ras.cut.road.2010 > 1] <- 1 # reclass
writeRaster (ras.cut.road.1980, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.1990, "D:\\tsr\\mackenzie\\data\\ras_cut_road_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2000, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2010, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2010.tif", format = "GTiff", overwrite=TRUE)
.905*.0818
plot (ras.cut.road.2000)
writeRaster (ras.cut.road.2000, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2010, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2010.tif", format = "GTiff", overwrite=TRUE)
ras.cut.road.2000 <- ras.roads.2000 + ras.cut.2000
ras.cut.road.2010 <- ras.roads.2010 + ras.cut.2010
ras.cut.road.2000 [ras.cut.road.2000 > 1] <- 1 # reclass
ras.cut.road.2010 [ras.cut.road.2010 > 1] <- 1 # reclass
plot (ras.cut.road.2000)
plot (ras.cut.road.2010)
writeRaster (ras.cut.road.2000, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2010, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2010.tif", format = "GTiff", overwrite=TRUE)
ras.roads.2000 <- raster::reclassify (ras.roads.hist, # all roads before 2000
c (-Inf,20,1, 20,Inf,0))
ras.roads.2010 <- raster::reclassify (ras.roads.hist, # all roads before 2010
c (-Inf,30,1, 30,Inf,0))
ras.cut.2000 <- raster::reclassify (ras.cut.current, # all cutblocks 1960-2000
c (NA,NA, 0, 20,60,1, 0,20,0, 60,Inf,0))
ras.cut.2010 <- raster::reclassify (ras.cut.current, # all cutblocks 1970-2010
c (NA,NA, 0, 10,50,1, 0,10,0, 50,Inf,0))
ras.cut.2000 <- resample (ras.cut.2000, ras.roads.2000, "bilinear")
ras.cut.2010 <- resample (ras.cut.2010, ras.roads.2010, "bilinear")
plot (ras.cut.2000)
plot (ras.roads.2000)
ras.cut.road.2000 <- ras.roads.2000 + ras.cut.2000
ras.cut.road.2010 <- ras.roads.2010 + ras.cut.2010
plot (ras.cut.road.2000)
plot (ras.cut.2000)
plot (ras.roads.2000)
plot (ras.cut.road.2000)
ras.roads.2000 <- raster::reclassify (ras.roads.hist, # all roads before 2000
c (NA,NA, 0, -Inf,20,1, 20,Inf,0))
ras.roads.2010 <- raster::reclassify (ras.roads.hist, # all roads before 2010
c (NA,NA, 0, -Inf,30,1, 30,Inf,0))
ras.cut.road.2000 <- ras.roads.2000 + ras.cut.2000
ras.cut.road.2010 <- ras.roads.2010 + ras.cut.2010
ras.cut.road.2000 [ras.cut.road.2000 > 1] <- 1 # reclass
ras.cut.road.2010 [ras.cut.road.2010 > 1] <- 1 # reclass
writeRaster (ras.cut.road.2000, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.cut.road.2010, "D:\\tsr\\mackenzie\\data\\ras_cut_road_2010.tif", format = "GTiff", overwrite=TRUE)
# the buffered rasters
ras.1980.cut.road.buff <- raster ("D:/tsr/mackenzie/data/ras_1980_cut_road_buff.tif")
ras.1990.cut.road.buff <- raster ("D:/tsr/mackenzie/data/ras_1990_cut_road_buff.tif")
ras.2000.cut.road.buff <- raster ("D:/tsr/mackenzie/data/ras_2000_cut_road_buff.tif")
ras.2010.cut.road.buff <- raster ("D:/tsr/mackenzie/data/ras_2010_cut_road_buff.tif")
ras.1980.cut.road.buff [ras.1980.cut.road.buff > 1] <- 1 # '2' are buffered areas; reclass to '1'
ras.1990.cut.road.buff [ras.1990.cut.road.buff > 1] <- 1 # '2' are buffered areas; reclass to '1'
ras.2000.cut.road.buff [ras.2000.cut.road.buff > 1] <- 1 # '2' are buffered areas; reclass to '1'
ras.2010.cut.road.buff [ras.2010.cut.road.buff > 1] <- 1 # '2' are buffered areas; reclass to '1'
ras.1980.cut.road.buff [is.na (ras.1980.cut.road.buff [])] <- 0 # make NA's = 0
ras.1990.cut.road.buff [is.na (ras.1990.cut.road.buff [])] <- 0 # make NA's = 0
ras.2000.cut.road.buff [is.na (ras.2000.cut.road.buff [])] <- 0 # make NA's = 0
ras.2010.cut.road.buff [is.na (ras.2010.cut.road.buff [])] <- 0 # make NA's = 0
## Load fire data
ras.fire.current <- raster ("D:/tsr/mackenzie/data/tsa16_fire_age.tif")
plot (ras.cut.current)
ras.fire.1980 <- raster::reclassify (ras.fire.current, # burns 1940-1980
c (1,40,0, 40,80,1))
plot (ras.fire.1980)
writeRaster (ras.fire.1980, "D:\\tsr\\mackenzie\\data\\ras_fire_1980.tif", format = "GTiff", overwrite=TRUE)
ras.fire.1980 <- raster::reclassify (ras.fire.current, # burns 1940-1980
c (1,40,0, 40,80,1, 80,Inf,0))
writeRaster (ras.fire.1980, "D:\\tsr\\mackenzie\\data\\ras_fire_1980.tif", format = "GTiff", overwrite=TRUE)
ras.fire.1990 <- raster::reclassify (ras.fire.current, # burns 1950-1990
c (1,30,0, 30,70,1, 70,Inf,0))
ras.fire.2000 <- raster::reclassify (ras.fire.current, # burns 1960-2000
c (1,20,0, 20,60,1, 60,Inf,0))
ras.fire.2010 <- raster::reclassify (ras.fire.current, # burns 1960-2000
c (1,10,0, 10,50,1, 50,Inf,0))
writeRaster (ras.fire.1990, "D:\\tsr\\mackenzie\\data\\ras_fire_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.fire.2000, "D:\\tsr\\mackenzie\\data\\ras_fire_2000.tif", format = "GTiff", overwrite=TRUE)
### add buffered disturbance to fire disturbance
ras.1980.disturb <- ras.1980.cut.road.buff + ras.fire.1980
ras.1990.disturb <- ras.1990.cut.road.buff + ras.fire.1990
ras.2000.disturb <- ras.2000.cut.road.buff + ras.fire.2000
ras.2010.disturb <- ras.2010.cut.road.buff + ras.fire.2010
ras.1980.disturb [ras.1980.disturb > 1] <- 1 # reclass again...
ras.1990.disturb [ras.1990.disturb > 1] <- 1 # reclass again...
ras.2000.disturb [ras.2000.disturb > 1] <- 1 # reclass again...
ras.2010.disturb [ras.2010.disturb > 1] <- 1 # reclass again...
plot (ras.1980.disturb)
plot (ras.1990.disturb)
plot (ras.2000.disturb)
plot (ras.2010.disturb)
writeRaster (ras.1980.disturb, "D:\\tsr\\mackenzie\\data\\ras_disturb_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.1990.disturb, "D:\\tsr\\mackenzie\\data\\ras_disturb_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.2000.disturb, "D:\\tsr\\mackenzie\\data\\ras_disturb_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.2010.disturb, "D:\\tsr\\mackenzie\\data\\ras_disturb_2010.tif", format = "GTiff", overwrite=TRUE)
# get lu's and awa's in critical habitat only
sf.hab.lu.mac <- st_make_valid (sf::st_intersection (sf.bc.crit.mac, sf.lu.mac))
conn <- DBI::dbConnect (PostgreSQL(),
host = keyring::key_get('dbhost', keyring = 'postgreSQL'),
dbname = keyring::key_get('dbname', keyring = 'postgreSQL'),
port='5432',
user=keyring::key_get('dbuser', keyring = 'postgreSQL') ,
password= keyring::key_get('dbpass', keyring = 'postgreSQL'))
## caribou critical habitat
sf.bc.crit <- st_make_valid (st_read (conn,
query = "SELECT * from bc_critical_habitat_all_herds_20200615;")
)
## caribou critical habitat
sf.bc.crit <- st_make_valid (st_read (conn,
query = "SELECT * from bc_critical_habitat_all_herds_20200615;")
)
sf.bc.crit.mac <- st_make_valid (sf::st_intersection (sf.mac.tsa.bounds, sf.bc.crit)) # in mackenzie only
### Boundary data
## mackenzie timber supply area
sf.mac.tsa.bounds <- st_make_valid (st_read (dsn = "D:/tsr/mackenzie/data/mackenzie_tsa.shp"))
sf.bc.crit.mac <- st_make_valid (sf::st_intersection (sf.mac.tsa.bounds, sf.bc.crit)) # in mackenzie only
rm (sf.bc.crit)
## watershed areas
sf.awa <- st_make_valid (st_read (dsn = "D:/tsr/mackenzie/data/fwa_assessment_watershed_poly.shp"))
sf.awa.mac <-  st_make_valid (sf::st_intersection (sf.mac.tsa.bounds, sf.awa)) # in mackenzie only
sf.awa.mac <- st_make_valid (st_read (dsn = "D:/tsr/mackenzie/data/fwa_mac_poly.shp"))
sf.lu.mac <- st_make_valid (st_read (dsn = "D:/tsr/mackenzie/data/lu_mac_poly.shp"))
# some geometry issues; this fixes them
sf.hab.lu.mac <- st_cast (sf.hab.lu.mac, "GEOMETRYCOLLECTION") %>% st_collection_extract ("POLYGON")
# get lu's and awa's in critical habitat only
sf.hab.lu.mac <- st_make_valid (sf::st_intersection (sf.bc.crit.mac, sf.lu.mac))
sf.hab.awa.mac <- st_make_valid (sf::st_intersection (sf.bc.crit.mac, sf.awa.mac))
# some geometry issues; this fixes them
sf.hab.lu.mac <- st_cast (sf.hab.lu.mac, "GEOMETRYCOLLECTION") %>% st_collection_extract ("POLYGON")
sf.hab.awa.mac <- st_cast (sf.hab.awa.mac, "GEOMETRYCOLLECTION") %>% st_collection_extract ("POLYGON")
## LUs ##
sf.hab.lu.mac$disturb_ha_1980 <- exactextractr::exact_extract (ras.1980.disturb,
sf.hab.lu.mac,
'sum')
sf.hab.lu.mac$disturb_ha_1990 <- exactextractr::exact_extract (ras.1990.disturb,
sf.hab.lu.mac,
'sum')
sf.hab.lu.mac$disturb_ha_2000 <- exactextractr::exact_extract (ras.2000.disturb,
sf.hab.lu.mac,
'sum')
sf.hab.lu.mac$disturb_ha_2010 <- exactextractr::exact_extract (ras.2010.disturb,
sf.hab.lu.mac,
'sum')
# calculate area of polys
sf.hab.lu.mac$calc_area_m2 <- st_area (sf.hab.lu.mac)
# drop geometry, calculate area in ha's and subset data
disturb.hab.lu.mac <- as.data.table (sf::st_drop_geometry (sf.hab.lu.mac))
disturb.hab.lu.mac$calc_area_ha <- disturb.hab.lu.mac$calc_area_m2 * 0.0001
disturb.hab.lu.mac$calc_area_ha <- units::drop_units (disturb.hab.lu.mac$calc_area_ha)
disturb.hab.lu.mac$herd_hab <- paste0 (disturb.hab.lu.mac$herd_name,
sep = "_",
disturb.hab.lu.mac$bchab_code
)
disturb.hab.lu.mac <- disturb.hab.lu.mac [, c ('TSA_NUMB_1', 'herd_name', 'bc_habitat_type', 'bchab_code', 'herd_hab', 'LANDSCAPE1', 'LANDSCAP_2', 'calc_area_ha', 'disturb_ha_1980', 'disturb_ha_1990', 'disturb_ha_2000', 'disturb_ha_2010')]
View(disturb.hab.lu.mac)
disturb.hab.lu.mac <- disturb.hab.lu.mac [, c ('TSA_NUMB_1', 'herd_name', 'bc_habitat_type', 'bchab_code', 'herd_hab', 'LANDSCAP_2', 'calc_area_ha', 'disturb_ha_1980', 'disturb_ha_1990', 'disturb_ha_2000', 'disturb_ha_2010')]
# summarize by LU Name
summ.disturb.lu <- disturb.hab.lu.mac [, .(disturb_ha_1980 = sum (disturb_ha_1980),
disturb_ha_1990 = sum (disturb_ha_1990),
disturb_ha_2000 = sum (disturb_ha_2000),
disturb_ha_2010 = sum (disturb_ha_2010),
calc_area_ha = sum (calc_area_ha)), by = .(LANDSCAP_2)]
summ.disturb.lu [, perc_disturb_1980 := (disturb_ha_1980 / calc_area_ha)*100]
summ.disturb.lu [, perc_disturb_1990 := (disturb_ha_1990 / calc_area_ha)*100]
summ.disturb.lu [, perc_disturb_2000 := (disturb_ha_2000 / calc_area_ha)*100]
summ.disturb.lu [, perc_disturb_2010 := (disturb_ha_2010 / calc_area_ha)*100]
View(summ.disturb.lu)
write.table (summ.disturb.lu,
file = "D:\\tsr\\mackenzie\\data\\disturbance_by_landscape_unit_historic.csv",
sep = ",")
## Critical Habitat ##
sf.bc.crit.mac$disturb_ha_1980 <- exactextractr::exact_extract (ras.1980.disturb,
sf.bc.crit.mac,
'sum')
sf.bc.crit.mac$disturb_ha_1990 <- exactextractr::exact_extract (ras.1990.disturb,
sf.bc.crit.mac,
'sum')
sf.bc.crit.mac$disturb_ha_2000 <- exactextractr::exact_extract (ras.2000.disturb,
sf.bc.crit.mac,
'sum')
sf.bc.crit.mac$disturb_ha_2010 <- exactextractr::exact_extract (ras.2010.disturb,
sf.bc.crit.mac,
'sum')
# calculate area of polys
sf.bc.crit.mac$calc_area_m2 <- st_area (sf.bc.crit.mac)
# drop geometry, calculate area in ha's and subset data
disturb.hab.mac <- as.data.table (sf::st_drop_geometry (sf.bc.crit.mac))
disturb.hab.mac$calc_area_ha <- disturb.hab.mac$calc_area_m2 * 0.0001
disturb.hab.mac$calc_area_ha <- units::drop_units (disturb.hab.mac$calc_area_ha)
disturb.hab.mac$herd_hab <- paste0 (disturb.hab.mac$herd_name,
sep = "_",
disturb.hab.mac$bchab_code
)
disturb.hab.mac <- disturb.hab.mac [, c ('TSA_NUMB_1', 'herd_name', 'bc_habitat_type', 'bchab_code', 'herd_hab', 'calc_area_ha', 'disturb_ha_2020', 'disturb_ha_2030', 'disturb_ha_2040', 'disturb_ha_2050', 'disturb_ha_2060', 'disturb_ha_2070', 'disturb_ha_2080', 'disturb_ha_2090')]
disturb.hab.mac <- disturb.hab.mac [, c ('TSA_NUMB_1', 'herd_name', 'bc_habitat_type', 'bchab_code', 'herd_hab', 'calc_area_ha', 'disturb_ha_1980', 'disturb_ha_1990', 'disturb_ha_2000', 'disturb_ha_2010')]
# summarize by crit hab
disturb.hab.mac <- disturb.hab.mac [, .(disturb_ha_1980 = sum (disturb_ha_1980),
disturb_ha_1990 = sum (disturb_ha_1990),
disturb_ha_2000 = sum (disturb_ha_2000),
disturb_ha_2010 = sum (disturb_ha_2010),
calc_area_ha = sum (calc_area_ha) ), by = .(herd_hab)]
disturb.hab.mac [, perc_disturb_1980 := (disturb_ha_1980 / calc_area_ha)*100]
disturb.hab.mac [, perc_disturb_1990 := (disturb_ha_1990 / calc_area_ha)*100]
disturb.hab.mac [, perc_disturb_2000 := (disturb_ha_2000 / calc_area_ha)*100]
disturb.hab.mac [, perc_disturb_2010 := (disturb_ha_2010 / calc_area_ha)*100]
write.table (disturb.hab.mac,
file = "D:\\tsr\\mackenzie\\data\\disturbance_by_crit_habitat_historic.csv",
sep = ",")
## Watershed Areas ##
sf.hab.awa.mac$disturb_ha_1980 <- exactextractr::exact_extract (ras.1980.disturb,
sf.hab.awa.mac,
'sum')
## Watershed Areas ##
sf.hab.awa.mac$disturb_ha_1980 <- exactextractr::exact_extract (ras.1980.disturb,
sf.hab.awa.mac,
'sum')
sf.hab.awa.mac$disturb_ha_1990 <- exactextractr::exact_extract (ras.1990.disturb,
sf.hab.awa.mac,
'sum')
sf.hab.awa.mac$disturb_ha_2000 <- exactextractr::exact_extract (ras.2000.disturb,
sf.hab.awa.mac,
'sum')
sf.hab.awa.mac$disturb_ha_2010 <- exactextractr::exact_extract (ras.2010.disturb,
sf.hab.awa.mac,
'sum')
# calculate area of polys
sf.hab.awa.mac$calc_area_m2 <- st_area (sf.hab.awa.mac)
# drop geometry, calculate area in ha's and subset data
disturb.hab.awa.mac <- as.data.table (sf::st_drop_geometry (sf.hab.awa.mac))
disturb.hab.awa.mac$calc_area_ha <- disturb.hab.awa.mac$calc_area_m2 * 0.0001
disturb.hab.awa.mac$calc_area_ha <- units::drop_units (disturb.hab.awa.mac$calc_area_ha)
disturb.hab.awa.mac <- disturb.hab.awa.mac [, c ('TSA_NUMB_1', 'herd_name', 'bc_habitat_type', 'bchab_code', 'WATERSHED_', 'calc_area_ha', 'disturb_ha_1980', 'disturb_ha_1990', 'disturb_ha_2000', 'disturb_ha_2010')]
# summarize by AWA
summ.disturb.awa <- disturb.hab.awa.mac [, .(disturb_ha_1980 = sum (disturb_ha_1980),
disturb_ha_1990 = sum (disturb_ha_1990),
disturb_ha_2000 = sum (disturb_ha_2000),
disturb_ha_2010 = sum (disturb_ha_2010),
calc_area_ha = sum (calc_area_ha)), by = .(WATERSHED_)]
summ.disturb.awa [, perc_disturb_1980 := (disturb_ha_1980 / calc_area_ha)*100]
summ.disturb.awa [, perc_disturb_1990 := (disturb_ha_1990 / calc_area_ha)*100]
summ.disturb.awa [, perc_disturb_2000 := (disturb_ha_2000 / calc_area_ha)*100]
summ.disturb.awa [, perc_disturb_2010 := (disturb_ha_2010 / calc_area_ha)*100]
write.table (summ.disturb.awa,
file = "D:\\tsr\\mackenzie\\data\\disturbance_by_watershed_historic.csv",
sep = ",")
# Roads
ras.roads.hist <- raster ("D:/tsr/mackenzie/data/MacKenzie_TSA_roads_1980_2020.tif")
ras.roads.1980 <- raster::reclassify (ras.roads.hist, # all roads before 1980
c (NA,NA, 0, -Inf,0,1, 0,Inf,0))
ras.roads.1990 <- raster::reclassify (ras.roads.hist, # all roads before 1990
c (NA,NA, 0, -Inf,10,1, 10,Inf,0))
ras.roads.2000 <- raster::reclassify (ras.roads.hist, # all roads before 2000
c (NA,NA, 0, -Inf,20,1, 20,Inf,0))
ras.roads.2010 <- raster::reclassify (ras.roads.hist, # all roads before 2010
c (NA,NA, 0, -Inf,30,1, 30,Inf,0))
plot (ras.roads.1980)
plot (ras.roads.1990)
plot (ras.roads.2000)
plot (ras.roads.2010)
writeRaster (ras.roads.1980, "D:\\tsr\\mackenzie\\data\\ras_roads_1980.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.roads.1990, "D:\\tsr\\mackenzie\\data\\ras_roads_1990.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.roads.2000, "D:\\tsr\\mackenzie\\data\\ras_roads_2000.tif", format = "GTiff", overwrite=TRUE)
writeRaster (ras.roads.2010, "D:\\tsr\\mackenzie\\data\\ras_roads_2010.tif", format = "GTiff", overwrite=TRUE)
